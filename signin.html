<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TVPLGM5QY9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-TVPLGM5QY9');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Sign in to your EPL News Hub account to access exclusive content and personalized features.">
    <meta name="keywords" content="EPL News Hub sign in, login, Premier League account">
    <title>Sign In | EPL News Hub</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dark-mode.css">
    <link rel="stylesheet" href="/mobile-master-optimize.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6480210605786899" crossorigin="anonymous"></script>
    <link rel="apple-touch-icon" href="/upscalemedia-transformed.png">
    <link rel="icon" type="image/png" href="/upscalemedia-transformed.png">
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCyOey0l27yQP68oybpoodMVcvayhIHt2I",
            authDomain: "epl-news-hub-94c09.firebaseapp.com",
            projectId: "epl-news-hub-94c09",
            storageBucket: "epl-news-hub-94c09.firebasestorage.app",
            messagingSenderId: "674703933278",
            appId: "1:674703933278:web:90c6dd4aa9f1ace73099cf",
            measurementId: "G-ECM6BCQCS8"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const googleProvider = new GoogleAuthProvider();
        
        // Make auth available globally
        window.auth = auth;
        window.googleProvider = googleProvider;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.signInWithPopup = signInWithPopup;
        window.onAuthStateChanged = onAuthStateChanged;
        window.signOut = signOut;
        
        // Force sign out when user visits this page to ensure fresh login
        signOut(auth).catch((error) => {
            console.log('Sign out on page load (if any):', error);
        });
        
        // Add scope for better user info
        googleProvider.addScope('profile');
        googleProvider.addScope('email');
    </script>
    <style>
        .auth-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 40px;
            background: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .auth-header h1 {
            font-family: Georgia, serif;
            font-size: 2rem;
            color: #333;
            margin-bottom: 10px;
        }
        
        .auth-header p {
            color: #666;
            font-size: 1rem;
        }
        
        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-group label {
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }
        
        .form-group input {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #0066cc;
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }
        
        .signin-btn {
            background: #0066cc;
            color: white;
            padding: 15px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .signin-btn:hover {
            background: #0052a3;
        }
        
        .auth-links {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .auth-links a {
            color: #0066cc;
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .auth-links a:hover {
            text-decoration: underline;
        }
        
        .forgot-password {
            text-align: center;
            margin-top: 15px;
        }
        
        .social-signin {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .social-btn {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
            cursor: pointer;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
            transition: background-color 0.3s ease;
        }
        
        .social-btn:hover {
            background: #f8f9fa;
        }
        
        .google-btn {
            border-color: #db4437;
            color: #db4437;
        }
        
        .facebook-btn {
            border-color: #4267B2;
            color: #4267B2;
        }
        
        .auth-divider {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }
        
        .auth-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #ddd;
        }
        
        .auth-divider span {
            background: white;
            padding: 0 15px;
            color: #666;
            font-size: 0.9rem;
        }
        
        .global-message {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .global-message.error {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .global-message.success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
    </style>
    <script src="dark-mode.js"></script>
</head>
<body>
    <div class="header" include="./header.html"></div>

    <!-- Main Content Area -->
    <main class="main-content">
        <div class="auth-container">
            <div class="auth-header">
                <h1>üîê Sign In</h1>
                <p>Welcome back to EPL News Hub</p>
            </div>

            <div id="auth-message" class="global-message" style="display: none;"></div>

            <form class="auth-form" onsubmit="handleSignIn(event)">
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" placeholder="Enter your email" required>
                </div>

                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" placeholder="Enter your password" required>
                </div>

                <button type="submit" class="signin-btn" id="signin-btn">
                    <span class="btn-text">Sign In</span>
                    <span class="btn-loader" style="display: none;">Signing In...</span>
                </button>
            </form>

            <div class="forgot-password">
                <a href="#" onclick="showForgotPassword()">Forgot your password?</a>
            </div>

            <div class="auth-divider">
                <span>or</span>
            </div>
            
            <button id="google-signin-btn" class="social-btn google-btn" type="button">
                <svg style="width: 20px; height: 20px; margin-right: 8px;" viewBox="0 0 24 24">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                <span>Continue with Google</span>
            </button>

            <div class="auth-links">
                <p>Don't have an account? <a href="/create-account.html">Create one here</a></p>
            </div>
        </div>
    </main>

    <!-- Comprehensive SEO Content Section -->
    <div style="background: #f8f9fa; padding: 60px 20px; margin-top: 40px;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <!-- Account Benefits and Sign-In Process -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Unlock Your Complete EPL News Hub Experience
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px;">
                        Signing in to your EPL News Hub account unlocks a world of exclusive content, personalized features, and advanced tools designed to enhance your Premier League experience. Whether you're a casual fan or a serious Fantasy Premier League manager, your account provides access to insights and analysis that can transform how you understand and enjoy the beautiful game.
                    </p>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Why Create an EPL News Hub Account?</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Your EPL News Hub account serves as your gateway to professional-grade football analysis and exclusive content that simply isn't available to casual visitors. By creating an account, you join a community of serious football enthusiasts who demand more than surface-level coverage and generic opinions. Our registered users gain access to insider insights, detailed tactical analysis, and proven FPL strategies that have helped thousands improve their understanding and performance.
                    </p>
                    
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        The registration process is completely free and takes less than two minutes. We've designed our authentication system to be secure yet simple, supporting both traditional email/password sign-in and convenient Google authentication for users who prefer streamlined access. Your account information is protected with industry-standard encryption and privacy protocols, ensuring your data remains secure while providing seamless access to our platform.
                    </p>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Exclusive Features for Registered Users</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Account holders immediately gain access to features that distinguish EPL News Hub from generic football news sites. Our registered users can save articles for later reading, receive personalized content recommendations based on their interests, and access our comprehensive archive of tactical analysis and FPL strategy guides. The platform learns from your reading patterns and preferences to deliver increasingly relevant content tailored to your specific interests.
                    </p>
                    
                    <div style="background: linear-gradient(135deg, #e8f4fd, #d4e7fc); padding: 30px; border-radius: 12px; margin: 30px 0; border-left: 4px solid #37003c;">
                        <h4 style="color: #37003c; margin-bottom: 15px; font-size: 1.3rem;">Seamless Sign-In Experience</h4>
                        <p style="line-height: 1.8; margin-bottom: 15px;">
                            "We've optimized our sign-in process to get you into your content as quickly as possible. With Google Sign-In integration, you can access your account with a single click, while our traditional email/password system includes features like password recovery and secure session management. Once signed in, you'll stay logged in across sessions for convenient access to all your personalized features."
                        </p>
                        <p style="color: #666; font-size: 0.9rem;">- Secure authentication powered by Firebase with enterprise-grade security</p>
                    </div>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Premium Membership Integration</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Your EPL News Hub account seamlessly integrates with our premium membership options, allowing you to upgrade to Starter or Pro access whenever you're ready to take your football knowledge to the next level. Premium members gain access to advanced FPL tools, exclusive transfer insights, AI-powered recommendations, and detailed tactical analysis that goes far beyond what's available to free users.
                    </p>
                    
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        The account system automatically tracks your membership status and ensures you have immediate access to all premium features upon upgrading. Whether you choose the affordable Starter plan at $2/month or the comprehensive Pro plan at $7/month, your account provides instant access to tools that have helped thousands of FPL managers improve their rankings dramatically.
                    </p>
                </div>
            </section>

            <!-- Sign-In Process and Account Benefits -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Simple Sign-In Process with Maximum Security
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px;">
                        We've engineered our sign-in process to balance security with convenience, ensuring your account remains protected while providing quick access to all your personalized content and features.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 30px; margin-bottom: 40px;">
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 30px; border-radius: 12px;">
                            <h3 style="color: #37003c; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.5rem;">üìß</span> Email & Password Sign-In
                            </h3>
                            <p style="line-height: 1.8; margin-bottom: 20px;">
                                Our traditional email and password authentication provides complete control over your account credentials. The system includes advanced security features such as password strength validation, secure session management, and automated password recovery options that ensure you never lose access to your account.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>Secure password encryption and storage</li>
                                <li>Automated password recovery via email</li>
                                <li>Session persistence for convenient access</li>
                                <li>Account activity monitoring and alerts</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 30px; border-radius: 12px;">
                            <h3 style="color: #37003c; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.5rem;">üîê</span> Google Sign-In Integration
                            </h3>
                            <p style="line-height: 1.8; margin-bottom: 20px;">
                                For users who prefer streamlined authentication, our Google Sign-In integration provides instant access using your existing Google credentials. This method eliminates the need to remember additional passwords while maintaining the highest security standards through Google's enterprise-grade authentication infrastructure.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>One-click sign-in with existing Google accounts</li>
                                <li>Enterprise-grade security through Google infrastructure</li>
                                <li>Automatic profile information synchronization</li>
                                <li>No additional passwords to remember or manage</li>
                            </ul>
                        </div>
                    </div>
                    
                    <h3 style="color: #37003c; margin-bottom: 20px;">Account Security and Privacy Protection</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Your account security is our highest priority. We employ industry-standard encryption protocols, secure data transmission, and comprehensive privacy protections to ensure your personal information remains safe and confidential. Our authentication system is powered by Firebase, Google's enterprise-grade backend service used by millions of applications worldwide.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #155724; margin-bottom: 10px;">üõ°Ô∏è Data Encryption</h4>
                            <p style="margin: 0; font-size: 0.95rem; line-height: 1.6;">All account data encrypted with industry-standard protocols during transmission and storage.</p>
                        </div>
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #155724; margin-bottom: 10px;">üîí Privacy Controls</h4>
                            <p style="margin: 0; font-size: 0.95rem; line-height: 1.6;">Complete control over your data with easy account management and deletion options.</p>
                        </div>
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #155724; margin-bottom: 10px;">‚ö° Secure Sessions</h4>
                            <p style="margin: 0; font-size: 0.95rem; line-height: 1.6;">Advanced session management ensures secure access across all your devices.</p>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #fff3cd, #ffeaa7); padding: 25px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: #856404; margin-bottom: 15px;">üîß Troubleshooting Sign-In Issues</h4>
                        <p style="line-height: 1.8; color: #856404; margin-bottom: 15px;">If you experience any difficulties signing in, our system includes comprehensive error handling and recovery options. Common issues such as forgotten passwords, browser compatibility, or popup blocking are automatically detected and resolved with clear guidance.</p>
                        <ul style="margin-left: 20px; line-height: 1.6; color: #856404;">
                            <li>Automated password recovery via secure email links</li>
                            <li>Browser compatibility checks and alternative sign-in methods</li>
                            <li>Popup blocker detection and workaround suggestions</li>
                            <li>24/7 technical support for account access issues</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Account Features and Personalization -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Personalized Features and Account Benefits
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px; text-align: center;">
                        Your EPL News Hub account unlocks a suite of personalized features designed to enhance your Premier League and Fantasy Football experience.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; margin-bottom: 40px;">
                        <div style="background: linear-gradient(135deg, #f0f8ff, #e6f3ff); padding: 30px; border-radius: 12px; border-left: 4px solid #007bff;">
                            <h3 style="color: #007bff; margin-bottom: 20px; font-size: 1.4rem;">üìö Personalized Content Feed</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Your account tracks your reading preferences and interests to deliver increasingly relevant content recommendations. The system learns which teams, players, and types of analysis you prefer, ensuring your homepage always features the most relevant articles and insights for your specific interests.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Team-specific content based on your preferences</li>
                                <li>FPL strategy articles matched to your manager style</li>
                                <li>Tactical analysis focused on your areas of interest</li>
                                <li>Breaking news alerts for topics you follow</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f0fff0, #e8f5e8); padding: 30px; border-radius: 12px; border-left: 4px solid #28a745;">
                            <h3 style="color: #28a745; margin-bottom: 20px; font-size: 1.4rem;">üíæ Article Bookmarking and History</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Never lose track of valuable insights again with our comprehensive bookmarking and reading history system. Save articles for later reference, create custom reading lists, and maintain a complete history of your EPL News Hub journey for easy access to previously read content.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Unlimited article bookmarking and organization</li>
                                <li>Complete reading history with search functionality</li>
                                <li>Custom tag system for content organization</li>
                                <li>Offline reading capability for saved articles</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #fff3cd, #ffeaa7); padding: 30px; border-radius: 12px; border-left: 4px solid #ffc107;">
                            <h3 style="color: #856404; margin-bottom: 20px; font-size: 1.4rem;">üéØ FPL Team Integration</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Connect your Fantasy Premier League team to unlock personalized advice and recommendations. Our system analyzes your current squad and provides targeted transfer suggestions, captaincy recommendations, and strategic insights based on your specific team composition and objectives.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Personalized transfer recommendations for your team</li>
                                <li>Custom captaincy suggestions based on your players</li>
                                <li>Team analysis and optimization recommendations</li>
                                <li>Performance tracking and improvement suggestions</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f8d7da, #f1b0b7); padding: 30px; border-radius: 12px; border-left: 4px solid #dc3545;">
                            <h3 style="color: #721c24; margin-bottom: 20px; font-size: 1.4rem;">üìä Analytics and Insights Dashboard</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Premium account holders gain access to a comprehensive analytics dashboard that tracks your reading patterns, content engagement, and provides insights into your football knowledge development. Monitor your progress as you become a more informed and successful football fan or FPL manager.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Reading analytics and engagement tracking</li>
                                <li>Knowledge development progress monitoring</li>
                                <li>Personalized learning recommendations</li>
                                <li>Community engagement and discussion participation</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #37003c, #6f42c1); color: white; padding: 40px; border-radius: 12px; text-align: center;">
                        <h3 style="margin-bottom: 20px; font-size: 1.8rem;">Ready to Unlock Your Premium Experience?</h3>
                        <p style="margin-bottom: 30px; font-size: 1.1rem; opacity: 0.9; max-width: 600px; margin-left: auto; margin-right: auto;">
                            Join thousands of football enthusiasts who've already discovered the difference that quality analysis and personalized features make to their Premier League experience.
                        </p>
                        <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                            <a href="/create-account.html" style="display: inline-block; background: #28a745; color: white; padding: 16px 30px; border-radius: 8px; text-decoration: none; font-size: 1.1rem; font-weight: 600;">
                                Create Free Account
                            </a>
                            <a href="/membership.html" style="display: inline-block; background: rgba(255,255,255,0.2); color: white; padding: 16px 30px; border-radius: 8px; text-decoration: none; font-size: 1.1rem; font-weight: 600; border: 2px solid rgba(255,255,255,0.3);">
                                View Premium Plans
                            </a>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <div class="footer" include="./footer.html"></div>
    <script src="./index.js"></script>
    
    <script>
        // Wait for Firebase to be fully loaded
        let firebaseReady = false;
        
        // Check Firebase initialization
        function checkFirebase() {
            if (window.auth && window.signInWithPopup && window.googleProvider) {
                firebaseReady = true;
                console.log('Firebase is ready');
                return true;
            }
            console.log('Firebase not ready yet...');
            return false;
        }
        
        // Wait for Firebase with timeout
        function waitForFirebase(callback, timeout = 5000) {
            const startTime = Date.now();
            const interval = setInterval(() => {
                if (checkFirebase()) {
                    clearInterval(interval);
                    callback(true);
                } else if (Date.now() - startTime > timeout) {
                    clearInterval(interval);
                    callback(false);
                }
            }, 100);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const signinForm = document.querySelector('.auth-form');
            const googleSigninBtn = document.getElementById('google-signin-btn');
            const messageDiv = document.getElementById('auth-message');
            const signinBtn = document.getElementById('signin-btn');
            const btnText = signinBtn.querySelector('.btn-text');
            const btnLoader = signinBtn.querySelector('.btn-loader');
            
            // Check if user is already signed in
            if (window.onAuthStateChanged && window.auth) {
                window.onAuthStateChanged(window.auth, (user) => {
                    if (user) {
                        // User is signed in, redirect to homepage
                        showMessage('Welcome back! Redirecting...', 'success');
                        setTimeout(() => {
                            window.location.href = '/';
                        }, 1500);
                    }
                });
            }
            
            // Email/Password Sign In
            signinForm.addEventListener('submit', handleSignIn);
            
            // Google Sign In with better error handling
            googleSigninBtn.addEventListener('click', async function(e) {
                e.preventDefault();
                
                console.log('Google Sign-In button clicked');
                
                // Show loading state
                googleSigninBtn.disabled = true;
                const originalContent = googleSigninBtn.innerHTML;
                googleSigninBtn.innerHTML = '<span>‚è≥</span> <span>Connecting to Google...</span>';
                
                // Wait for Firebase to be ready
                waitForFirebase(async (isReady) => {
                    if (!isReady) {
                        showMessage('‚ö†Ô∏è Firebase is still loading. Please try again in a moment.', 'error');
                        googleSigninBtn.disabled = false;
                        googleSigninBtn.innerHTML = originalContent;
                        return;
                    }
                    
                    try {
                        console.log('Starting Google Sign-In popup...');
                        
                        // Configure provider
                        window.googleProvider.setCustomParameters({
                            prompt: 'select_account'
                        });
                        
                        const result = await window.signInWithPopup(window.auth, window.googleProvider);
                        const user = result.user;
                        
                        console.log('Google sign-in successful:', user);
                        showMessage('‚úÖ Google sign in successful! Redirecting...', 'success');
                        
                        // Store user info in localStorage
                        const userData = {
                            uid: user.uid,
                            email: user.email,
                            displayName: user.displayName,
                            photoURL: user.photoURL,
                            signedInAt: new Date().toISOString(),
                            provider: 'google'
                        };
                        localStorage.setItem('user', JSON.stringify(userData));
                        
                        // Check for existing membership data and associate with user
                        checkAndUpdateMembershipData(user.uid, user.email);
                        
                        setTimeout(() => {
                            window.location.href = '/';
                        }, 1500);
                    } catch (error) {
                        console.error('Google sign in error:', error);
                        
                        let errorMessage = '‚ùå Google sign in failed. ';
                        
                        switch (error.code) {
                            case 'auth/popup-closed-by-user':
                                errorMessage = 'Sign-in cancelled. Please try again when ready.';
                                break;
                            case 'auth/popup-blocked':
                                errorMessage = 'üö´ Popup was blocked. Please allow popups for this site and try again.';
                                break;
                            case 'auth/cancelled-popup-request':
                                errorMessage = 'Another sign-in popup is already open.';
                                break;
                            case 'auth/network-request-failed':
                                errorMessage = 'üåê Network error. Please check your connection and try again.';
                                break;
                            case 'auth/unauthorized-domain':
                                errorMessage = '‚ö†Ô∏è This domain is not authorized. Please contact support.';
                                break;
                            case 'auth/operation-not-allowed':
                                errorMessage = '‚ö†Ô∏è Google Sign-In is not enabled. Please contact support.';
                                break;
                            default:
                                errorMessage += error.message || 'Please try again.';
                        }
                        
                        if (error.code !== 'auth/popup-closed-by-user') {
                            showMessage(errorMessage, 'error');
                        }
                    } finally {
                        // Reset button state
                        googleSigninBtn.disabled = false;
                        googleSigninBtn.innerHTML = originalContent;
                    }
                });
            });
        });
        
        async function handleSignIn(event) {
            event.preventDefault();
            
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            const signinBtn = document.getElementById('signin-btn');
            const btnText = signinBtn.querySelector('.btn-text');
            const btnLoader = signinBtn.querySelector('.btn-loader');
            
            if (!email || !password) {
                showMessage('Please fill in all fields.', 'error');
                return;
            }
            
            if (!isValidEmail(email)) {
                showMessage('Please enter a valid email address.', 'error');
                return;
            }
            
            // Show loading state
            setLoadingState(true);
            
            try {
                if (window.signInWithEmailAndPassword && window.auth) {
                    const userCredential = await window.signInWithEmailAndPassword(window.auth, email, password);
                    const user = userCredential.user;
                    
                    showMessage('Sign in successful! Redirecting...', 'success');
                    
                    // Store user info in localStorage for the site
                    const userData = {
                        uid: user.uid,
                        email: user.email,
                        displayName: user.displayName || email.split('@')[0],
                        signedInAt: new Date().toISOString()
                    };
                    localStorage.setItem('user', JSON.stringify(userData));
                    
                    // Check for existing membership data and associate with user
                    checkAndUpdateMembershipData(user.uid, user.email);
                    
                    setTimeout(() => {
                        window.location.href = '/';
                    }, 1500);
                } else {
                    // Fallback for when Firebase is not configured
                    showMessage('‚ö†Ô∏è Firebase authentication not configured. Please set up your Firebase project first.', 'error');
                }
            } catch (error) {
                console.error('Sign in error:', error);
                let errorMessage = 'Sign in failed. Please try again.';
                
                switch (error.code) {
                    case 'auth/user-not-found':
                        errorMessage = 'No account found with this email. Please create an account first.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Incorrect password. Please try again.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email address.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = 'Too many failed attempts. Please try again later.';
                        break;
                }
                
                showMessage(errorMessage, 'error');
            } finally {
                setLoadingState(false);
            }
        }
        
        function setLoadingState(loading) {
            const signinBtn = document.getElementById('signin-btn');
            const btnText = signinBtn.querySelector('.btn-text');
            const btnLoader = signinBtn.querySelector('.btn-loader');
            
            signinBtn.disabled = loading;
            if (loading) {
                btnText.style.display = 'none';
                btnLoader.style.display = 'inline';
            } else {
                btnText.style.display = 'inline';
                btnLoader.style.display = 'none';
            }
        }
        
        function showMessage(message, type) {
            const messageDiv = document.getElementById('auth-message');
            messageDiv.textContent = message;
            messageDiv.className = `global-message ${type}`;
            messageDiv.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                }, 5000);
            }
        }
        
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
        
        function showForgotPassword() {
            const email = document.getElementById('email').value.trim();
            
            if (!email) {
                showMessage('Please enter your email address first.', 'error');
                return;
            }
            
            // This would implement password reset with Firebase
            showMessage('Password reset functionality will be implemented with Firebase. Please contact support for now.', 'error');
        }
        
        function checkAndUpdateMembershipData(userUid, userEmail) {
            try {
                // Check for existing membership data in localStorage
                const membershipInfo = localStorage.getItem('membership');
                const eplMembership = localStorage.getItem('eplMembership');
                
                let membership = null;
                
                // Check both possible storage keys
                if (membershipInfo) {
                    membership = JSON.parse(membershipInfo);
                } else if (eplMembership) {
                    membership = JSON.parse(eplMembership);
                }
                
                if (membership) {
                    // Associate membership with current user
                    membership.userId = userUid;
                    membership.userEmail = userEmail;
                    membership.lastUpdated = new Date().toISOString();
                    
                    // Store under user-specific key for better organization
                    const userMembershipKey = `membership_${userUid}`;
                    localStorage.setItem(userMembershipKey, JSON.stringify(membership));
                    localStorage.setItem('membership', JSON.stringify(membership)); // Keep for backward compatibility
                    
                    console.log('Membership data associated with user:', membership);
                }
            } catch (error) {
                console.error('Error checking membership data:', error);
            }
        }
    </script>
    <script src="/mobile-enhance.js"></script>
</body>
</html>