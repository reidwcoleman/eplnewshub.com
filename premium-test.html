<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium Access Control Test Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .button-free { background: #e74c3c; color: white; }
        .button-starter { background: #f39c12; color: white; }
        .button-pro { background: #27ae60; color: white; }
        .button-logout { background: #95a5a6; color: white; }
        .status-display {
            padding: 15px;
            background: #ecf0f1;
            border-radius: 5px;
            margin: 10px 0;
        }
        .premium-link {
            display: inline-block;
            padding: 10px 15px;
            margin: 5px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 5px;
        }
        .test-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>üîí Premium Access Control Test Page</h1>
    <p><strong>Development Tool:</strong> Test premium access control for FPL features</p>
    
    <div class="test-section">
        <h2>Current User Status</h2>
        <div id="status-display" class="status-display">
            Loading user status...
        </div>
        
        <h3>Simulate User Login</h3>
        <button class="button button-free" onclick="simulateUser('free')">
            üÜì Free User (5 AI queries/day)
        </button>
        <button class="button button-starter" onclick="simulateUser('starter')">
            ‚öΩ Starter Member (50 AI queries/day)
        </button>
        <button class="button button-pro" onclick="simulateUser('pro')">
            üèÜ Pro Member (Unlimited access)
        </button>
        <button class="button button-logout" onclick="simulateLogout()">
            üö™ Logout
        </button>
    </div>
    
    <div class="test-section">
        <h2>Test Premium Features</h2>
        <p>Click on these links to test access control:</p>
        
        <div class="test-links">
            <a href="./fpl-ai-assistant.html" class="premium-link">
                ü§ñ FPL AI Assistant
            </a>
            <a href="./transfer-simulator-pro.html" class="premium-link">
                üîÑ Transfer Simulator Pro
            </a>
            <a href="./player-data-enhanced.html" class="premium-link">
                üìä Player Analytics Suite
            </a>
            <a href="./player-predictor.html" class="premium-link">
                üîÆ Points Predictor
            </a>
            <a href="./budget-optimizer.html" class="premium-link">
                üí∞ Budget Optimizer
            </a>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Free Features (Should Always Work)</h2>
        <div class="test-links">
            <a href="./stats.html" class="premium-link" style="background: #27ae60;">
                üìà Live Stats Dashboard
            </a>
            <a href="./fixture-tracker.html" class="premium-link" style="background: #27ae60;">
                ‚ö° Fixture Tracker
            </a>
            <a href="./team-analyzer.html" class="premium-link" style="background: #27ae60;">
                ‚öîÔ∏è Team Analyzer
            </a>
        </div>
    </div>
    
    <div class="test-section">
        <h2>AI Query Test</h2>
        <p>Test AI Assistant usage limits:</p>
        <button class="button" style="background: #9b59b6; color: white;" onclick="simulateAIQuery()">
            ü§ñ Simulate AI Query
        </button>
        <div id="ai-usage" style="margin-top: 10px;"></div>
    </div>
    
    <div class="test-section">
        <h2>Expected Behavior</h2>
        <ul>
            <li><strong>Free Users:</strong> Can access free features, limited AI (5/day), blocked from all premium tools</li>
            <li><strong>Starter Members:</strong> Can access Transfer Simulator + Player Analytics, moderate AI (50/day), blocked from Pro-only tools</li>
            <li><strong>Pro Members:</strong> Can access all features with unlimited usage</li>
            <li><strong>Starter+ Tools:</strong> Transfer Simulator Pro, Player Analytics Suite</li>
            <li><strong>Pro-Only Tools:</strong> Points Predictor, Budget Optimizer</li>
            <li><strong>AI Assistant:</strong> Limited free access, full access for Starter/Pro</li>
        </ul>
    </div>
    
    <script src="./premium-access-control.js"></script>
    <script>
        // Enable dev mode
        localStorage.setItem('devMode', 'true');
        
        function simulateUser(membershipLevel) {
            if (window.premiumAccessControl) {
                window.premiumAccessControl.simulateLogin(membershipLevel);
            } else {
                // Fallback if access control not loaded yet
                localStorage.setItem('userLoggedIn', 'true');
                localStorage.setItem('membershipLevel', membershipLevel);
                location.reload();
            }
        }
        
        function simulateLogout() {
            if (window.premiumAccessControl) {
                window.premiumAccessControl.simulateLogout();
            } else {
                localStorage.removeItem('userLoggedIn');
                localStorage.removeItem('membershipLevel');
                localStorage.removeItem('dailyUsage');
                location.reload();
            }
        }
        
        function simulateAIQuery() {
            if (window.premiumAccessControl) {
                window.premiumAccessControl.updateDailyUsage('ai-assistant');
                updateStatusDisplay();
                updateAIUsage();
            }
        }
        
        function updateStatusDisplay() {
            const statusDiv = document.getElementById('status-display');
            if (window.premiumAccessControl) {
                const status = window.premiumAccessControl.userStatus;
                const aiAccess = window.premiumAccessControl.hasAccess('fpl-ai-assistant.html');
                
                statusDiv.innerHTML = `
                    <strong>Login Status:</strong> ${status.isLoggedIn ? '‚úÖ Logged In' : '‚ùå Not Logged In'}<br>
                    <strong>Membership:</strong> ${status.membershipLevel.toUpperCase()}<br>
                    <strong>AI Queries Today:</strong> ${status.dailyUsage.aiQueries}<br>
                    <strong>AI Access:</strong> ${aiAccess.hasAccess ? '‚úÖ Available' : '‚ùå Limit Reached'}
                    ${aiAccess.remaining !== undefined ? ` (${aiAccess.remaining} remaining)` : ''}
                `;
            } else {
                statusDiv.innerHTML = 'Access control system not loaded yet...';
            }
        }
        
        function updateAIUsage() {
            const usageDiv = document.getElementById('ai-usage');
            if (window.premiumAccessControl) {
                const status = window.premiumAccessControl.userStatus;
                const access = window.premiumAccessControl.hasAccess('fpl-ai-assistant.html');
                
                usageDiv.innerHTML = `
                    <strong>Queries used today:</strong> ${status.dailyUsage.aiQueries}<br>
                    <strong>Access status:</strong> ${access.hasAccess ? '‚úÖ Can use' : '‚ùå Limit reached'}
                    ${access.remaining !== undefined ? ` (${access.remaining} remaining)` : ''}
                `;
            }
        }
        
        // Update status when page loads
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                updateStatusDisplay();
                updateAIUsage();
            }, 500);
        });
        
        // Update status periodically
        setInterval(() => {
            if (window.premiumAccessControl) {
                updateStatusDisplay();
                updateAIUsage();
            }
        }, 2000);
    </script>
</body>
</html>