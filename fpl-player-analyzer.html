<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TVPLGM5QY9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-TVPLGM5QY9');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Advanced Fantasy Premier League player analyzer and comparison tool. Deep dive into player stats, form analysis, and head-to-head comparisons for FPL success.">
    <meta name="keywords" content="fantasy premier league, FPL player analyzer, player comparison, FPL statistics, player profiles, fantasy football analysis">
    <meta name="author" content="EPL News Hub">
    <meta name="robots" content="index, follow">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.eplnewshub.com/player-predictor.html">
    
    <title>FPL Player Analyzer & Comparison Tool | EPL News Hub</title>
    <link rel="stylesheet" href="styles.css">
    <script src="fpl-data-service.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding-bottom: 40px;
        }
        
        .analyzer-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .analyzer-header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }
        
        .analyzer-header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .analyzer-header p {
            font-size: 1.2rem;
            opacity: 0.95;
        }
        
        /* Mode Selector */
        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .mode-btn {
            padding: 15px 40px;
            background: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .mode-btn.active {
            background: linear-gradient(135deg, #00ff87 0%, #00d084 100%);
            color: white;
            transform: scale(1.05);
        }
        
        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        /* Main Tool Card */
        .analyzer-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: fadeInUp 0.8s ease;
        }
        
        /* Player Search Section */
        .player-search-section {
            margin-bottom: 30px;
        }
        
        .search-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .player-search {
            flex: 1;
            min-width: 250px;
            position: relative;
        }
        
        .player-search input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .player-search input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }
        
        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            margin-top: 5px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .suggestions.active {
            display: block;
        }
        
        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .suggestion-item:hover {
            background: #f7f7f7;
        }
        
        .player-info {
            display: flex;
            flex-direction: column;
        }
        
        .player-name {
            font-weight: 600;
            color: #1a1a1a;
        }
        
        .player-details {
            font-size: 0.85rem;
            color: #666;
        }
        
        .player-price {
            font-weight: 700;
            color: #667eea;
            font-size: 1.1rem;
        }
        
        /* Analysis Mode */
        .analysis-mode {
            display: none;
        }
        
        .analysis-mode.active {
            display: block;
        }
        
        /* Comparison Mode */
        .comparison-mode {
            display: none;
        }
        
        .comparison-mode.active {
            display: block;
        }
        
        /* Player Profile Card */
        .player-profile {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            animation: slideIn 0.5s ease;
        }
        
        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .profile-info h2 {
            font-size: 2rem;
            color: #1a1a1a;
            margin-bottom: 5px;
        }
        
        .profile-meta {
            display: flex;
            gap: 15px;
            font-size: 0.95rem;
            color: #666;
        }
        
        .profile-badge {
            background: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .profile-price {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .stat-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-change {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .stat-change.positive {
            color: #00d084;
        }
        
        .stat-change.negative {
            color: #ff4757;
        }
        
        /* Form Chart */
        .form-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .form-header h3 {
            font-size: 1.3rem;
            color: #1a1a1a;
        }
        
        .form-chart {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            height: 150px;
            align-items: flex-end;
        }
        
        .form-bar {
            flex: 1;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px 10px 0 0;
            position: relative;
            min-height: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .form-bar:hover {
            opacity: 0.8;
            transform: scaleY(1.05);
        }
        
        .form-bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: #666;
        }
        
        .form-bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: 700;
            color: #667eea;
        }
        
        /* Fixtures Section */
        .fixtures-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .fixtures-header {
            margin-bottom: 20px;
        }
        
        .fixtures-header h3 {
            font-size: 1.3rem;
            color: #1a1a1a;
        }
        
        .fixtures-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .fixture-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .fixture-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        .fixture-opponent {
            font-weight: 600;
            color: #1a1a1a;
        }
        
        .fixture-difficulty {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
        }
        
        .difficulty-1, .difficulty-2 {
            background: #00d084;
        }
        
        .difficulty-3 {
            background: #ffa500;
        }
        
        .difficulty-4, .difficulty-5 {
            background: #ff4757;
        }
        
        /* Comparison Grid */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .vs-divider {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            padding: 20px;
        }
        
        /* Comparison Stats */
        .comparison-stats {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .comparison-row {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .comparison-row:last-child {
            border-bottom: none;
        }
        
        .comparison-value {
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .comparison-value.left {
            text-align: right;
        }
        
        .comparison-value.right {
            text-align: left;
        }
        
        .comparison-value.better {
            color: #00d084;
        }
        
        .comparison-label {
            text-align: center;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            flex: 1;
            min-width: 200px;
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        /* Loading State */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 60px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .analyzer-header h1 {
                font-size: 2rem;
            }
            
            .mode-selector {
                flex-direction: column;
                gap: 10px;
            }
            
            .mode-btn {
                width: 100%;
            }
            
            .analyzer-card {
                padding: 20px;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .vs-divider {
                padding: 10px;
            }
            
            .profile-header {
                flex-direction: column;
                text-align: center;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="header" include="./header.html"></div>
    
    <div class="analyzer-container">
        <div class="analyzer-header">
            <h1>⚡ FPL Player Analyzer</h1>
            <p>Deep dive into player stats, compare performances, and make informed transfer decisions</p>
        </div>
        
        <!-- Mode Selector -->
        <div class="mode-selector">
            <button class="mode-btn active" onclick="switchMode('analysis')">
                📊 Player Analysis
            </button>
            <button class="mode-btn" onclick="switchMode('comparison')">
                ⚔️ Compare Players
            </button>
        </div>
        
        <!-- Main Tool Card -->
        <div class="analyzer-card">
            <!-- Analysis Mode -->
            <div class="analysis-mode active" id="analysisMode">
                <div class="player-search-section">
                    <h2 style="margin-bottom: 20px; color: #1a1a1a;">Select a Player to Analyze</h2>
                    <div class="search-container">
                        <div class="player-search">
                            <input type="text" 
                                   id="analysisPlayerSearch" 
                                   placeholder="Search for a player..."
                                   onkeyup="searchPlayers('analysis')">
                            <div class="suggestions" id="analysisSuggestions"></div>
                        </div>
                    </div>
                </div>
                
                <div id="analysisContent">
                    <!-- Player profile will be loaded here -->
                    <div style="text-align: center; padding: 60px; color: #999;">
                        <p style="font-size: 1.2rem;">Start by searching for a player above</p>
                    </div>
                </div>
            </div>
            
            <!-- Comparison Mode -->
            <div class="comparison-mode" id="comparisonMode">
                <div class="player-search-section">
                    <h2 style="margin-bottom: 20px; color: #1a1a1a;">Compare Players</h2>
                    <div class="search-container">
                        <div class="player-search">
                            <input type="text" 
                                   id="comparePlayer1Search" 
                                   placeholder="Search for first player..."
                                   onkeyup="searchPlayers('compare1')">
                            <div class="suggestions" id="compare1Suggestions"></div>
                        </div>
                        <div class="player-search">
                            <input type="text" 
                                   id="comparePlayer2Search" 
                                   placeholder="Search for second player..."
                                   onkeyup="searchPlayers('compare2')">
                            <div class="suggestions" id="compare2Suggestions"></div>
                        </div>
                    </div>
                </div>
                
                <div id="comparisonContent">
                    <!-- Comparison will be loaded here -->
                    <div style="text-align: center; padding: 60px; color: #999;">
                        <p style="font-size: 1.2rem;">Select two players to compare</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer" include="./footer.html"></div>
    
    <script src="index.js"></script>
    <script>
        // Initialize FPL Data Service
        const dataService = new FPLDataServiceEnhanced();
        let allPlayers = [];
        let teams = {};
        
        let selectedPlayers = {
            analysis: null,
            compare1: null,
            compare2: null
        };
        
        // Load player data on page load
        async function loadPlayers() {
            try {
                const data = await dataService.getPlayerData();
                
                // Store teams data
                teams = {};
                data.teams.forEach(team => {
                    teams[team.id] = {
                        name: team.name,
                        short_name: team.short_name
                    };
                });
                
                // Process player data
                allPlayers = data.elements.map(player => ({
                    id: player.id,
                    name: `${player.first_name} ${player.second_name}`,
                    team: teams[player.team]?.name || 'Unknown',
                    team_short: teams[player.team]?.short_name || 'UNK',
                    position: getPositionName(player.element_type),
                    price: player.now_cost / 10,
                    points: player.total_points,
                    form: parseFloat(player.form),
                    goals: player.goals_scored,
                    assists: player.assists,
                    cleanSheets: player.clean_sheets,
                    saves: player.saves || 0,
                    bonus: player.bonus,
                    minutes: player.minutes,
                    yellowCards: player.yellow_cards,
                    redCards: player.red_cards,
                    ownership: parseFloat(player.selected_by_percent),
                    influence: parseFloat(player.influence),
                    creativity: parseFloat(player.creativity),
                    threat: parseFloat(player.threat),
                    ict_index: parseFloat(player.ict_index),
                    transfers_in: player.transfers_in_event,
                    transfers_out: player.transfers_out_event,
                    news: player.news,
                    chance: player.chance_of_playing_next_round,
                    ppg: player.minutes > 0 ? (player.total_points / (player.minutes / 90)).toFixed(1) : '0.0',
                    value: player.total_points > 0 ? (player.total_points / (player.now_cost / 10)).toFixed(1) : '0.0'
                }));
                
                // Sort by total points for better initial experience
                allPlayers.sort((a, b) => b.points - a.points);
                
                console.log('Loaded', allPlayers.length, 'players');
            } catch (error) {
                console.error('Error loading players:', error);
                // Use fallback data if needed
            }
        }
        
        function getPositionName(type) {
            switch(type) {
                case 1: return 'GKP';
                case 2: return 'DEF';
                case 3: return 'MID';
                case 4: return 'FWD';
                default: return 'Unknown';
            }
        }
        
        // Load players when page loads
        document.addEventListener('DOMContentLoaded', loadPlayers);
        
        function switchMode(mode) {
            // Update button states
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update content visibility
            document.querySelectorAll('.analysis-mode, .comparison-mode').forEach(el => el.classList.remove('active'));
            
            if (mode === 'analysis') {
                document.getElementById('analysisMode').classList.add('active');
            } else {
                document.getElementById('comparisonMode').classList.add('active');
            }
        }
        
        function searchPlayers(searchType) {
            const searchInput = searchType === 'analysis' 
                ? document.getElementById('analysisPlayerSearch')
                : searchType === 'compare1'
                ? document.getElementById('comparePlayer1Search')
                : document.getElementById('comparePlayer2Search');
            
            const suggestionsDiv = searchType === 'analysis'
                ? document.getElementById('analysisSuggestions')
                : searchType === 'compare1'
                ? document.getElementById('compare1Suggestions')
                : document.getElementById('compare2Suggestions');
            
            const query = searchInput.value.toLowerCase();
            
            if (query.length < 2 || allPlayers.length === 0) {
                suggestionsDiv.classList.remove('active');
                return;
            }
            
            const matches = allPlayers.filter(player => 
                player.name.toLowerCase().includes(query) ||
                player.team.toLowerCase().includes(query)
            ).slice(0, 10); // Limit to 10 suggestions
            
            if (matches.length > 0) {
                suggestionsDiv.innerHTML = matches.map(player => `
                    <div class="suggestion-item" onclick="selectPlayer(${player.id}, '${searchType}')">
                        <div class="player-info">
                            <div class="player-name">${player.name}</div>
                            <div class="player-details">${player.team} - ${player.position}</div>
                        </div>
                        <div class="player-price">£${player.price.toFixed(1)}m</div>
                    </div>
                `).join('');
                suggestionsDiv.classList.add('active');
            } else {
                suggestionsDiv.classList.remove('active');
            }
        }
        
        function selectPlayer(playerId, searchType) {
            const player = allPlayers.find(p => p.id === playerId);
            if (!player) return;
            
            selectedPlayers[searchType] = player;
            
            // Update input field
            const searchInput = searchType === 'analysis' 
                ? document.getElementById('analysisPlayerSearch')
                : searchType === 'compare1'
                ? document.getElementById('comparePlayer1Search')
                : document.getElementById('comparePlayer2Search');
            
            searchInput.value = player.name;
            
            // Hide suggestions
            const suggestionsDiv = searchType === 'analysis'
                ? document.getElementById('analysisSuggestions')
                : searchType === 'compare1'
                ? document.getElementById('compare1Suggestions')
                : document.getElementById('compare2Suggestions');
            
            suggestionsDiv.classList.remove('active');
            
            // Load content based on mode
            if (searchType === 'analysis') {
                loadPlayerAnalysis(player);
            } else {
                if (selectedPlayers.compare1 && selectedPlayers.compare2) {
                    loadPlayerComparison();
                }
            }
        }
        
        function loadPlayerAnalysis(player) {
            const content = document.getElementById('analysisContent');
            
            // Use real player stats
            const stats = {
                goals: player.goals || 0,
                assists: player.assists || 0,
                cleanSheets: player.cleanSheets || 0,
                bonus: player.bonus || 0,
                minutes: player.minutes || 0,
                ppg: player.ppg || '0.0',
                ownership: player.ownership || '0.0',
                xG: (player.threat / 10).toFixed(1),
                xA: (player.creativity / 10).toFixed(1),
                influence: player.influence || 0,
                ict: player.ict_index || 0,
                yellowCards: player.yellowCards || 0,
                redCards: player.redCards || 0,
                saves: player.saves || 0,
                value: player.value || '0.0'
            };
            
            // Generate form data (mock for now as we don't have gameweek data)
            const formData = Array(5).fill(0).map(() => Math.floor(Math.random() * 12) + 1);
            
            content.innerHTML = `
                <div class="player-profile">
                    <div class="profile-header">
                        <div class="profile-info">
                            <h2>${player.name}</h2>
                            <div class="profile-meta">
                                <span class="profile-badge">${player.team}</span>
                                <span class="profile-badge">${player.position}</span>
                                <span class="profile-badge">⭐ Form: ${player.form}</span>
                            </div>
                        </div>
                        <div class="profile-price">
                            £${player.price}m
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Total Points</div>
                            <div class="stat-value">${player.points}</div>
                            ${player.transfers_in > player.transfers_out ? 
                                `<div class="stat-change positive">↑ ${(player.transfers_in/1000).toFixed(0)}k transfers in</div>` :
                                `<div class="stat-change negative">↓ ${(player.transfers_out/1000).toFixed(0)}k transfers out</div>`
                            }
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Points Per Game</div>
                            <div class="stat-value">${stats.ppg}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Ownership</div>
                            <div class="stat-value">${stats.ownership.toFixed(1)}%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Value</div>
                            <div class="stat-value">${stats.value}</div>
                        </div>
                        ${player.position === 'FWD' || player.position === 'MID' ? `
                        <div class="stat-card">
                            <div class="stat-label">Goals</div>
                            <div class="stat-value">${stats.goals}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Assists</div>
                            <div class="stat-value">${stats.assists}</div>
                        </div>
                        ` : ''}
                        ${player.position === 'DEF' || player.position === 'GKP' ? `
                        <div class="stat-card">
                            <div class="stat-label">Clean Sheets</div>
                            <div class="stat-value">${stats.cleanSheets}</div>
                        </div>
                        ` : ''}
                        ${player.position === 'GKP' ? `
                        <div class="stat-card">
                            <div class="stat-label">Saves</div>
                            <div class="stat-value">${stats.saves}</div>
                        </div>
                        ` : ''}
                        <div class="stat-card">
                            <div class="stat-label">Bonus Points</div>
                            <div class="stat-value">${stats.bonus}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Minutes</div>
                            <div class="stat-value">${stats.minutes}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ICT Index</div>
                            <div class="stat-value">${stats.ict.toFixed(1)}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Influence</div>
                            <div class="stat-value">${stats.influence.toFixed(1)}</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <div class="form-header">
                        <h3>Recent Form</h3>
                        <span style="color: #666; font-size: 0.9rem;">Last 5 Gameweeks</span>
                    </div>
                    <div class="form-chart">
                        ${formData.map((points, index) => `
                            <div class="form-bar" style="height: ${(points/15)*100}%">
                                <div class="form-bar-value">${points}</div>
                                <div class="form-bar-label">GW${20-4+index}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="fixtures-section">
                    <div class="fixtures-header">
                        <h3>Upcoming Fixtures</h3>
                    </div>
                    <div class="fixtures-list">
                        <div class="fixture-item">
                            <span class="fixture-opponent">Newcastle (H)</span>
                            <span class="fixture-difficulty difficulty-2">2</span>
                        </div>
                        <div class="fixture-item">
                            <span class="fixture-opponent">Arsenal (A)</span>
                            <span class="fixture-difficulty difficulty-4">4</span>
                        </div>
                        <div class="fixture-item">
                            <span class="fixture-opponent">Bournemouth (H)</span>
                            <span class="fixture-difficulty difficulty-1">1</span>
                        </div>
                        <div class="fixture-item">
                            <span class="fixture-opponent">Man City (A)</span>
                            <span class="fixture-difficulty difficulty-5">5</span>
                        </div>
                        <div class="fixture-item">
                            <span class="fixture-opponent">Brighton (H)</span>
                            <span class="fixture-difficulty difficulty-3">3</span>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn btn-primary" onclick="addToWatchlist(${player.id})">
                        + Add to Watchlist
                    </button>
                    <button class="action-btn btn-secondary" onclick="viewTransferSuggestions(${player.id})">
                        View Transfer Options
                    </button>
                </div>
            `;
        }
        
        function loadPlayerComparison() {
            const player1 = selectedPlayers.compare1;
            const player2 = selectedPlayers.compare2;
            const content = document.getElementById('comparisonContent');
            
            // Use real player stats
            const stats1 = {
                goals: player1.goals || 0,
                assists: player1.assists || 0,
                ppg: player1.ppg || '0.0',
                minutes: player1.minutes || 0,
                bonus: player1.bonus || 0,
                cleanSheets: player1.cleanSheets || 0,
                value: player1.value || '0.0',
                ownership: player1.ownership || 0
            };
            
            const stats2 = {
                goals: player2.goals || 0,
                assists: player2.assists || 0,
                ppg: player2.ppg || '0.0',
                minutes: player2.minutes || 0,
                bonus: player2.bonus || 0,
                cleanSheets: player2.cleanSheets || 0,
                value: player2.value || '0.0',
                ownership: player2.ownership || 0
            };
            
            content.innerHTML = `
                <div class="comparison-grid">
                    <div class="player-profile">
                        <div class="profile-header">
                            <div class="profile-info">
                                <h2>${player1.name}</h2>
                                <div class="profile-meta">
                                    <span class="profile-badge">${player1.team}</span>
                                    <span class="profile-badge">${player1.position}</span>
                                </div>
                            </div>
                            <div class="profile-price">£${player1.price}m</div>
                        </div>
                    </div>
                    
                    <div class="vs-divider">VS</div>
                    
                    <div class="player-profile">
                        <div class="profile-header">
                            <div class="profile-info">
                                <h2>${player2.name}</h2>
                                <div class="profile-meta">
                                    <span class="profile-badge">${player2.team}</span>
                                    <span class="profile-badge">${player2.position}</span>
                                </div>
                            </div>
                            <div class="profile-price">£${player2.price}m</div>
                        </div>
                    </div>
                </div>
                
                <div class="comparison-stats">
                    <div class="comparison-row">
                        <div class="comparison-value left ${player1.points > player2.points ? 'better' : ''}">${player1.points}</div>
                        <div class="comparison-label">Total Points</div>
                        <div class="comparison-value right ${player2.points > player1.points ? 'better' : ''}">${player2.points}</div>
                    </div>
                    
                    <div class="comparison-row">
                        <div class="comparison-value left ${parseFloat(stats1.ppg) > parseFloat(stats2.ppg) ? 'better' : ''}">${stats1.ppg}</div>
                        <div class="comparison-label">Points Per Game</div>
                        <div class="comparison-value right ${parseFloat(stats2.ppg) > parseFloat(stats1.ppg) ? 'better' : ''}">${stats2.ppg}</div>
                    </div>
                    
                    <div class="comparison-row">
                        <div class="comparison-value left ${player1.form > player2.form ? 'better' : ''}">${player1.form}</div>
                        <div class="comparison-label">Current Form</div>
                        <div class="comparison-value right ${player2.form > player1.form ? 'better' : ''}">${player2.form}</div>
                    </div>
                    
                    <div class="comparison-row">
                        <div class="comparison-value left ${stats1.goals > stats2.goals ? 'better' : ''}">${stats1.goals}</div>
                        <div class="comparison-label">Goals</div>
                        <div class="comparison-value right ${stats2.goals > stats1.goals ? 'better' : ''}">${stats2.goals}</div>
                    </div>
                    
                    <div class="comparison-row">
                        <div class="comparison-value left ${stats1.assists > stats2.assists ? 'better' : ''}">${stats1.assists}</div>
                        <div class="comparison-label">Assists</div>
                        <div class="comparison-value right ${stats2.assists > stats1.assists ? 'better' : ''}">${stats2.assists}</div>
                    </div>
                    
                    <div class="comparison-row">
                        <div class="comparison-value left ${stats1.minutes > stats2.minutes ? 'better' : ''}">${stats1.minutes}</div>
                        <div class="comparison-label">Minutes Played</div>
                        <div class="comparison-value right ${stats2.minutes > stats1.minutes ? 'better' : ''}">${stats2.minutes}</div>
                    </div>
                    
                    <div class="comparison-row">
                        <div class="comparison-value left ${player1.price < player2.price ? 'better' : ''}">£${player1.price}m</div>
                        <div class="comparison-label">Price</div>
                        <div class="comparison-value right ${player2.price < player1.price ? 'better' : ''}">£${player2.price}m</div>
                    </div>
                    
                    <div class="comparison-row">
                        <div class="comparison-value left ${stats1.bonus > stats2.bonus ? 'better' : ''}">${stats1.bonus}</div>
                        <div class="comparison-label">Bonus Points</div>
                        <div class="comparison-value right ${stats2.bonus > stats1.bonus ? 'better' : ''}">${stats2.bonus}</div>
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 25px; border-radius: 15px; margin-top: 30px; text-align: center;">
                    <h3 style="font-size: 1.5rem; margin-bottom: 15px; color: #1a1a1a;">
                        ${player1.points > player2.points ? '🏆 ' + player1.name + ' Wins!' : '🏆 ' + player2.name + ' Wins!'}
                    </h3>
                    <p style="color: #666; font-size: 1.1rem;">
                        Based on overall statistics, ${player1.points > player2.points ? player1.name : player2.name} 
                        appears to be the better FPL option with ${Math.abs(player1.points - player2.points)} more total points.
                    </p>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn btn-primary" onclick="compareMore()">
                        Compare Different Players
                    </button>
                    <button class="action-btn btn-secondary" onclick="exportComparison()">
                        Export Comparison
                    </button>
                </div>
            `;
        }
        
        // Placeholder functions for actions
        function addToWatchlist(playerId) {
            alert('Player added to watchlist! (Feature coming soon)');
        }
        
        function viewTransferSuggestions(playerId) {
            alert('Transfer suggestions feature coming soon!');
        }
        
        function compareMore() {
            selectedPlayers.compare1 = null;
            selectedPlayers.compare2 = null;
            document.getElementById('comparePlayer1Search').value = '';
            document.getElementById('comparePlayer2Search').value = '';
            document.getElementById('comparisonContent').innerHTML = `
                <div style="text-align: center; padding: 60px; color: #999;">
                    <p style="font-size: 1.2rem;">Select two players to compare</p>
                </div>
            `;
        }
        
        function exportComparison() {
            alert('Export feature coming soon!');
        }
        
        // Close suggestions when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.player-search')) {
                document.querySelectorAll('.suggestions').forEach(s => s.classList.remove('active'));
            }
        });
    </script>
</body>
</html>
