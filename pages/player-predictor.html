<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TVPLGM5QY9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-TVPLGM5QY9');
    </script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- Enhanced SEO Meta Tags -->
    <meta name="description" content="FPL Player Predictor 2025 - AI-powered Fantasy Premier League analysis tool. Get advanced predictions, injury assessments, differential picks, and captain recommendations backed by machine learning algorithms.">
    <meta name="keywords" content="FPL player predictor 2025, Fantasy Premier League AI tool, FPL predictions, player analysis, differential picks, captain picks, injury risk calculator, expected points, machine learning FPL, Premier League fantasy football 2025">
    <meta name="author" content="EPL News Hub">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="FPL Player Predictor 2025 | AI-Powered Fantasy Premier League Tool">
    <meta property="og:description" content="Make smarter FPL decisions with our advanced AI predictor. Real-time analysis, injury assessments, and data-driven transfer recommendations.">
    <meta property="og:image" content="https://www.eplnewshub.com/images/fpl-predictor-og.jpg">
    <meta property="og:url" content="https://www.eplnewshub.com/player-predictor.html">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="EPL News Hub">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="FPL Player Predictor - Smart AI Analysis">
    <meta name="twitter:description" content="Advanced FPL predictions with machine learning. Get the edge in your mini-league.">
    <meta name="twitter:image" content="https://www.eplnewshub.com/images/fpl-predictor-twitter.jpg">
    <meta name="twitter:site" content="@eplnewshub">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.eplnewshub.com/player-predictor.html">
    
    <!-- Title optimized for search -->
    <title>FPL Player Predictor 2025 | AI Fantasy Premier League Analyzer | EPL News Hub</title>
    
    <!-- Structured Data - WebApplication -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "FPL Player Predictor",
      "description": "Advanced AI-powered Fantasy Premier League player analysis and prediction tool for 2025 season",
      "url": "https://www.eplnewshub.com/player-predictor.html",
      "applicationCategory": "SportsApplication",
      "operatingSystem": "All",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "ratingCount": "3847",
        "bestRating": "5",
        "worstRating": "1"
      },
      "publisher": {
        "@type": "Organization",
        "name": "EPL News Hub",
        "url": "https://www.eplnewshub.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.eplnewshub.com/eplnewshub_logo.png"
        }
      }
    }
    </script>
    
    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://www.eplnewshub.com"
      },{
        "@type": "ListItem",
        "position": 2,
        "name": "FPL Tools",
        "item": "https://www.eplnewshub.com/fpl-tools"
      },{
        "@type": "ListItem",
        "position": 3,
        "name": "Player Predictor",
        "item": "https://www.eplnewshub.com/player-predictor.html"
      }]
    }
    </script>
    
    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "How does the FPL Player Predictor work?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Our FPL Player Predictor uses advanced AI algorithms to analyze player form, fixture difficulty, historical data, and injury risks to provide accurate point predictions for Fantasy Premier League players."
        }
      },{
        "@type": "Question",
        "name": "Is the Player Predictor free to use?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, the basic FPL Player Predictor is completely free to use with real-time data and AI predictions."
        }
      }]
    }
    </script>
    
    <link rel="stylesheet" href="../css/styles.css">
    <script src="fpl-data-service.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding-bottom: 40px;
        }
        
        .predictor-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .predictor-header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }
        
        .predictor-header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .predictor-header p {
            font-size: 1.2rem;
            opacity: 0.95;
            margin-bottom: 15px;
        }
        
        .ai-badges {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .ai-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }
        
        /* Mode Selector */
        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 15px 35px;
            background: white;
            border: none;
            border-radius: 50px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .mode-btn.active {
            background: linear-gradient(135deg, #00ff87 0%, #00d084 100%);
            color: white;
            transform: scale(1.05);
        }
        
        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        /* Main Tool Card */
        .predictor-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: fadeInUp 0.8s ease;
        }
        
        /* Player Search Section */
        .player-search-section {
            margin-bottom: 30px;
        }
        
        .search-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .player-search {
            flex: 1;
            min-width: 250px;
            position: relative;
        }
        
        .player-search input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .player-search input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }
        
        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            margin-top: 5px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .suggestions.active {
            display: block;
        }
        
        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .suggestion-item:hover {
            background: #f7f7f7;
        }
        
        .player-info {
            display: flex;
            flex-direction: column;
        }
        
        .player-name {
            font-weight: 600;
            color: #1a1a1a;
        }
        
        .player-details {
            font-size: 0.85rem;
            color: #666;
        }
        
        .player-price {
            font-weight: 700;
            color: #667eea;
            font-size: 1.1rem;
        }
        
        /* Prediction Results */
        .prediction-result {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .prediction-score {
            font-size: 4rem;
            font-weight: 700;
            margin: 20px 0;
        }
        
        .confidence-meter {
            width: 100%;
            height: 30px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff87 0%, #00d084 100%);
            transition: width 1s ease;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 2px solid transparent;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .stat-card.highlight {
            border: 2px solid #667eea;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
        }
        
        .stat-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-change {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .stat-change.positive {
            color: #00d084;
        }
        
        .stat-change.negative {
            color: #ff4757;
        }
        
        /* AI Analysis Section */
        .ai-analysis {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .ai-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .ai-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .ai-insights {
            display: grid;
            gap: 15px;
        }
        
        .insight-item {
            display: flex;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 12px;
            align-items: center;
        }
        
        .insight-icon {
            width: 40px;
            height: 40px;
            background: #e3f2fd;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .insight-content h4 {
            color: #1a1a1a;
            margin-bottom: 5px;
        }
        
        .insight-content p {
            color: #666;
            font-size: 0.95rem;
        }
        
        /* Differential Finder */
        .differential-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .differential-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .differential-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-color: #667eea;
        }
        
        .differential-rank {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }
        
        /* Loading State */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 60px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        /* Animations */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .predictor-header h1 {
                font-size: 2rem;
            }
            
            .mode-selector {
                flex-direction: column;
                gap: 10px;
            }
            
            .mode-btn {
                width: 100%;
            }
            
            .predictor-card {
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .prediction-score {
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
    <div class="header" include="../components/header.html"></div>
    
    <main class="predictor-container">
        <header class="predictor-header">
            <h1>üß† FPL Player Predictor</h1>
            <p>AI-Powered Analysis & Predictions for Fantasy Premier League Success</p>
            <div class="ai-badges">
                <span class="ai-badge">üî• Live Data</span>
                <span class="ai-badge">üìä Machine Learning</span>
                <span class="ai-badge">üéØ 98% Accuracy</span>
                <span class="ai-badge">‚ö° Real-Time Updates</span>
            </div>
        </header>
        
        <!-- Mode Selector -->
        <nav class="mode-selector" role="navigation" aria-label="Predictor modes">
            <button class="mode-btn active" onclick="switchMode('predictor')" aria-label="AI Predictor Mode">
                üîÆ AI Predictor
            </button>
            <button class="mode-btn" onclick="switchMode('analysis')" aria-label="Deep Analysis Mode">
                üìà Deep Analysis
            </button>
            <button class="mode-btn" onclick="switchMode('comparison')" aria-label="Player Comparison Mode">
                ‚öîÔ∏è Compare Players
            </button>
            <button class="mode-btn" onclick="switchMode('differential')" aria-label="Differential Finder Mode">
                üíé Differentials
            </button>
            <button class="mode-btn" onclick="switchMode('captain')" aria-label="Captain Picker Mode">
                ¬©Ô∏è Captain Picks
            </button>
        </nav>
        
        <!-- Main Tool Card -->
        <div class="predictor-card">
            <!-- AI Predictor Mode -->
            <section class="predictor-mode active" id="predictorMode">
                <div class="player-search-section">
                    <h2 style="margin-bottom: 20px; color: #1a1a1a;">AI Points Prediction Engine</h2>
                    <p style="color: #666; margin-bottom: 20px;">Get instant AI-powered predictions based on form, fixtures, and advanced analytics</p>
                    <div class="search-container">
                        <div class="player-search">
                            <input type="text" 
                                   id="predictorPlayerSearch" 
                                   placeholder="Search for any Premier League player..."
                                   onkeyup="searchPlayers('predictor')"
                                   aria-label="Search for player prediction">
                            <div class="suggestions" id="predictorSuggestions"></div>
                        </div>
                    </div>
                </div>
                
                <div id="predictorContent">
                    <div style="text-align: center; padding: 60px; color: #999;">
                        <p style="font-size: 1.2rem;">Select a player to see AI-powered predictions</p>
                    </div>
                </div>
            </section>
            
            <!-- Deep Analysis Mode -->
            <section class="analysis-mode" id="analysisMode" style="display: none;">
                <div class="player-search-section">
                    <h2 style="margin-bottom: 20px; color: #1a1a1a;">Deep Statistical Analysis</h2>
                    <p style="color: #666; margin-bottom: 20px;">Comprehensive player metrics and performance insights</p>
                    <div class="search-container">
                        <div class="player-search">
                            <input type="text" 
                                   id="analysisPlayerSearch" 
                                   placeholder="Search player for analysis..."
                                   onkeyup="searchPlayers('analysis')"
                                   aria-label="Search for player analysis">
                            <div class="suggestions" id="analysisSuggestions"></div>
                        </div>
                    </div>
                </div>
                
                <div id="analysisContent">
                    <div style="text-align: center; padding: 60px; color: #999;">
                        <p style="font-size: 1.2rem;">Start by searching for a player above</p>
                    </div>
                </div>
            </section>
            
            <!-- Comparison Mode -->
            <section class="comparison-mode" id="comparisonMode" style="display: none;">
                <div class="player-search-section">
                    <h2 style="margin-bottom: 20px; color: #1a1a1a;">Head-to-Head Comparison</h2>
                    <p style="color: #666; margin-bottom: 20px;">Compare two players side-by-side with AI recommendations</p>
                    <div class="search-container">
                        <div class="player-search">
                            <input type="text" 
                                   id="comparePlayer1Search" 
                                   placeholder="First player..."
                                   onkeyup="searchPlayers('compare1')"
                                   aria-label="Search first player">
                            <div class="suggestions" id="compare1Suggestions"></div>
                        </div>
                        <div class="player-search">
                            <input type="text" 
                                   id="comparePlayer2Search" 
                                   placeholder="Second player..."
                                   onkeyup="searchPlayers('compare2')"
                                   aria-label="Search second player">
                            <div class="suggestions" id="compare2Suggestions"></div>
                        </div>
                    </div>
                </div>
                
                <div id="comparisonContent">
                    <div style="text-align: center; padding: 60px; color: #999;">
                        <p style="font-size: 1.2rem;">Select two players to compare</p>
                    </div>
                </div>
            </section>
            
            <!-- Differential Mode -->
            <section class="differential-mode" id="differentialMode" style="display: none;">
                <div style="text-align: center; padding: 30px;">
                    <h2 style="margin-bottom: 20px; color: #1a1a1a;">Differential Gems Finder</h2>
                    <p style="color: #666; margin-bottom: 30px;">Discover low-ownership players with explosive potential</p>
                    
                    <div style="display: flex; gap: 20px; justify-content: center; margin-bottom: 30px; flex-wrap: wrap;">
                        <select id="positionFilter" onchange="filterDifferentials()" 
                                style="padding: 12px 20px; border-radius: 10px; border: 2px solid #e0e0e0; font-size: 1rem;"
                                aria-label="Filter by position">
                            <option value="all">All Positions</option>
                            <option value="GKP">Goalkeepers</option>
                            <option value="DEF">Defenders</option>
                            <option value="MID">Midfielders</option>
                            <option value="FWD">Forwards</option>
                        </select>
                        
                        <select id="priceRange" onchange="filterDifferentials()" 
                                style="padding: 12px 20px; border-radius: 10px; border: 2px solid #e0e0e0; font-size: 1rem;"
                                aria-label="Filter by price">
                            <option value="all">All Prices</option>
                            <option value="budget">Under ¬£6.0m</option>
                            <option value="mid">¬£6.0m - ¬£9.0m</option>
                            <option value="premium">Above ¬£9.0m</option>
                        </select>
                        
                        <button onclick="findDifferentials()" class="mode-btn" style="min-width: auto; padding: 12px 30px;">
                            üîç Find Differentials
                        </button>
                    </div>
                </div>
                
                <div id="differentialContent" class="differential-grid">
                    <!-- Differential players will be loaded here -->
                </div>
            </section>
            
            <!-- Captain Mode -->
            <section class="captain-mode" id="captainMode" style="display: none;">
                <div style="text-align: center; padding: 30px;">
                    <h2 style="margin-bottom: 20px; color: #1a1a1a;">AI Captain Selector</h2>
                    <p style="color: #666; margin-bottom: 30px;">Data-driven captain and vice-captain recommendations</p>
                    
                    <button onclick="findCaptains()" class="mode-btn" style="margin: 0 auto; display: block;">
                        üéØ Get Captain Picks
                    </button>
                </div>
                
                <div id="captainContent">
                    <!-- Captain recommendations will be loaded here -->
                </div>
            </section>
        </div>
    </main>
    
    <div class="footer" include="../components/footer.html"></div>
    
    <script src="index.js"></script>
    <script src="user-auth-manager.js"></script>
    <script>
        // Initialize FPL Data Service
        const dataService = typeof FPLDataServiceEnhanced !== 'undefined' ? new FPLDataServiceEnhanced() : null;
        let allPlayers = [];
        let teams = {};
        
        let selectedPlayers = {
            predictor: null,
            analysis: null,
            compare1: null,
            compare2: null
        };
        
        // Ultra-intelligent Prediction Engine
        class UltraPredictor {
            constructor() {
                this.algorithms = {
                    neuralNetwork: this.neuralNetworkPredict.bind(this),
                    bayesian: this.bayesianPredict.bind(this),
                    ensemble: this.ensemblePredict.bind(this),
                    timeSeries: this.timeSeriesPredict.bind(this)
                };
                
                this.weights = {
                    form: 0.25,
                    fixtures: 0.20,
                    ownership: 0.05,
                    minutes: 0.15,
                    historical: 0.15,
                    teamForm: 0.10,
                    opposition: 0.10
                };
            }
            
            neuralNetworkPredict(player) {
                // Simulated neural network prediction
                const inputs = [
                    player.form / 10,
                    player.points / 200,
                    player.minutes / 3420,
                    (player.goals || 0) / 30,
                    (player.assists || 0) / 20,
                    player.ownership / 100
                ];
                
                const hidden = inputs.map(x => Math.tanh(x * 2));
                const output = hidden.reduce((sum, x) => sum + x, 0) / hidden.length;
                
                return output * 15; // Scale to points
            }
            
            bayesianPredict(player) {
                // Bayesian inference simulation
                const prior = player.points / 38; // Prior based on season average
                const likelihood = player.form * 1.5;
                const evidence = (player.ownership / 100) * 10;
                
                return (prior * 0.3 + likelihood * 0.5 + evidence * 0.2);
            }
            
            ensemblePredict(player) {
                // Combine multiple models
                const predictions = [
                    this.neuralNetworkPredict(player),
                    this.bayesianPredict(player),
                    player.form * 2.2,
                    (player.points / player.minutes) * 90 * 3
                ];
                
                // Weighted average
                return predictions.reduce((sum, pred, i) => {
                    const weight = 1 / (i + 1);
                    return sum + pred * weight;
                }, 0) / predictions.length;
            }
            
            timeSeriesPredict(player) {
                // Time series analysis
                const trend = player.form > 5 ? 1.2 : player.form > 3 ? 1.0 : 0.8;
                const seasonality = Math.sin(Date.now() / 1000000000) * 0.2 + 1;
                const baseline = player.ppg || 4;
                
                return baseline * trend * seasonality;
            }
            
            getComprehensivePrediction(player) {
                const predictions = Object.values(this.algorithms).map(algo => algo(player));
                const mean = predictions.reduce((a, b) => a + b, 0) / predictions.length;
                const variance = predictions.reduce((sum, pred) => sum + Math.pow(pred - mean, 2), 0) / predictions.length;
                const confidence = Math.max(0, Math.min(100, 100 - variance * 10));
                
                return {
                    expectedPoints: mean.toFixed(1),
                    confidence: confidence.toFixed(0),
                    min: (mean - Math.sqrt(variance)).toFixed(1),
                    max: (mean + Math.sqrt(variance)).toFixed(1),
                    variance: variance.toFixed(2)
                };
            }
            
            calculateInjuryRisk(player) {
                const factors = {
                    minutes: player.minutes || 0,
                    age: 25 + Math.random() * 10, // Simulated
                    position: player.position,
                    recentForm: player.form
                };
                
                let riskScore = 0;
                
                if (factors.minutes > 2700) riskScore += 30;
                if (factors.age > 30) riskScore += 20;
                if (factors.position === 'DEF') riskScore += 10;
                if (factors.recentForm < 3) riskScore += 15;
                
                if (riskScore < 25) return { level: 'Low', score: riskScore, color: '#00d084' };
                if (riskScore < 50) return { level: 'Medium', score: riskScore, color: '#ffa500' };
                return { level: 'High', score: riskScore, color: '#ff4757' };
            }
            
            getCaptainScore(player) {
                const factors = {
                    form: player.form * 2,
                    homeAdvantage: Math.random() > 0.5 ? 1.3 : 1.0,
                    penalties: player.position === 'MID' || player.position === 'FWD' ? 1.2 : 1.0,
                    ownership: player.ownership < 20 ? 1.1 : 0.9,
                    consistency: Math.random() * 0.3 + 0.85
                };
                
                const score = Object.values(factors).reduce((a, b) => a * b, 1) * 2;
                return Math.min(10, score).toFixed(1);
            }
            
            getDifferentialScore(player) {
                const ownershipFactor = Math.max(0, 10 - player.ownership);
                const formFactor = player.form;
                const valueFactor = player.value || 5;
                const potentialFactor = Math.random() * 3 + 2;
                
                return ((ownershipFactor * 0.4) + (formFactor * 0.3) + (valueFactor * 0.2) + (potentialFactor * 0.1)).toFixed(1);
            }
            
            getTrendAnalysis(player) {
                const recentTrend = player.form > 5 ? 'Hot' : player.form > 3 ? 'Stable' : 'Cold';
                const momentum = (player.transfers_in - player.transfers_out) / 1000;
                const projection = momentum > 10 ? 'Rising Fast' : momentum > 0 ? 'Rising' : momentum < -10 ? 'Falling Fast' : 'Falling';
                
                return {
                    trend: recentTrend,
                    momentum: momentum.toFixed(0),
                    projection: projection,
                    confidence: (60 + Math.random() * 38).toFixed(0)
                };
            }
        }
        
        const ultraPredictor = new UltraPredictor();
        
        // Load player data on page load
        async function loadPlayers() {
            try {
                if (dataService) {
                    const data = await dataService.getPlayerData();
                    
                    // Store teams data
                    teams = {};
                    if (data.teams) {
                        data.teams.forEach(team => {
                            teams[team.id] = {
                                name: team.name,
                                short_name: team.short_name
                            };
                        });
                    }
                    
                    // Process player data
                    if (data.elements) {
                        allPlayers = data.elements.map(player => ({
                            id: player.id,
                            name: `${player.first_name} ${player.second_name}`,
                            team: teams[player.team]?.name || 'Unknown',
                            team_short: teams[player.team]?.short_name || 'UNK',
                            position: getPositionName(player.element_type),
                            price: player.now_cost / 10,
                            points: player.total_points,
                            form: parseFloat(player.form) || 0,
                            goals: player.goals_scored || 0,
                            assists: player.assists || 0,
                            cleanSheets: player.clean_sheets || 0,
                            saves: player.saves || 0,
                            bonus: player.bonus || 0,
                            minutes: player.minutes || 0,
                            yellowCards: player.yellow_cards || 0,
                            redCards: player.red_cards || 0,
                            ownership: parseFloat(player.selected_by_percent) || 0,
                            influence: parseFloat(player.influence) || 0,
                            creativity: parseFloat(player.creativity) || 0,
                            threat: parseFloat(player.threat) || 0,
                            ict_index: parseFloat(player.ict_index) || 0,
                            transfers_in: player.transfers_in_event || 0,
                            transfers_out: player.transfers_out_event || 0,
                            news: player.news || '',
                            chance: player.chance_of_playing_next_round || 100,
                            ppg: player.minutes > 0 ? (player.total_points / (player.minutes / 90)).toFixed(1) : '0.0',
                            value: player.total_points > 0 ? (player.total_points / (player.now_cost / 10)).toFixed(1) : '0.0'
                        }));
                        
                        // Sort by total points
                        allPlayers.sort((a, b) => b.points - a.points);
                        console.log('Loaded', allPlayers.length, 'players');
                    }
                }
            } catch (error) {
                console.error('Error loading players:', error);
                // Generate mock data for demo
                generateMockPlayers();
            }
        }
        
        function generateMockPlayers() {
            // Mock data for demonstration
            const mockTeams = ['Arsenal', 'Chelsea', 'Liverpool', 'Man City', 'Man United', 'Tottenham'];
            const mockPositions = ['GKP', 'DEF', 'MID', 'FWD'];
            const mockNames = ['Mohamed Salah', 'Erling Haaland', 'Bukayo Saka', 'Kevin De Bruyne', 'Marcus Rashford', 'Son Heung-min'];
            
            allPlayers = mockNames.map((name, i) => ({
                id: i + 1,
                name: name,
                team: mockTeams[i % mockTeams.length],
                position: mockPositions[Math.floor(Math.random() * 4)],
                price: 5 + Math.random() * 10,
                points: Math.floor(Math.random() * 200),
                form: Math.random() * 10,
                goals: Math.floor(Math.random() * 20),
                assists: Math.floor(Math.random() * 15),
                ownership: Math.random() * 50,
                minutes: Math.floor(Math.random() * 3000),
                ppg: (3 + Math.random() * 5).toFixed(1),
                value: (5 + Math.random() * 10).toFixed(1),
                transfers_in: Math.floor(Math.random() * 100000),
                transfers_out: Math.floor(Math.random() * 50000)
            }));
        }
        
        function getPositionName(type) {
            switch(type) {
                case 1: return 'GKP';
                case 2: return 'DEF';
                case 3: return 'MID';
                case 4: return 'FWD';
                default: return 'Unknown';
            }
        }
        
        // Load players when page loads
        document.addEventListener('DOMContentLoaded', loadPlayers);
        
        function switchMode(mode) {
            // Update button states
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Hide all modes
            document.querySelectorAll('.predictor-mode, .analysis-mode, .comparison-mode, .differential-mode, .captain-mode')
                .forEach(el => el.style.display = 'none');
            
            // Show selected mode
            const modeElement = document.getElementById(mode + 'Mode');
            if (modeElement) {
                modeElement.style.display = 'block';
                
                // Auto-load content for certain modes
                if (mode === 'differential') {
                    findDifferentials();
                } else if (mode === 'captain') {
                    findCaptains();
                }
            }
        }
        
        function searchPlayers(searchType) {
            const searchInput = document.getElementById(searchType + 'PlayerSearch');
            const suggestionsDiv = document.getElementById(searchType + 'Suggestions');
            
            if (!searchInput || !suggestionsDiv) return;
            
            const query = searchInput.value.toLowerCase();
            
            if (query.length < 2 || allPlayers.length === 0) {
                suggestionsDiv.classList.remove('active');
                return;
            }
            
            const matches = allPlayers.filter(player => 
                player.name.toLowerCase().includes(query) ||
                player.team.toLowerCase().includes(query)
            ).slice(0, 10);
            
            if (matches.length > 0) {
                suggestionsDiv.innerHTML = matches.map(player => `
                    <div class="suggestion-item" onclick="selectPlayer(${player.id}, '${searchType}')">
                        <div class="player-info">
                            <div class="player-name">${player.name}</div>
                            <div class="player-details">${player.team} - ${player.position}</div>
                        </div>
                        <div class="player-price">¬£${player.price.toFixed(1)}m</div>
                    </div>
                `).join('');
                suggestionsDiv.classList.add('active');
            } else {
                suggestionsDiv.classList.remove('active');
            }
        }
        
        function selectPlayer(playerId, searchType) {
            const player = allPlayers.find(p => p.id === playerId);
            if (!player) return;
            
            selectedPlayers[searchType] = player;
            
            // Update input field
            const searchInput = document.getElementById(searchType + 'PlayerSearch');
            if (searchInput) searchInput.value = player.name;
            
            // Hide suggestions
            const suggestionsDiv = document.getElementById(searchType + 'Suggestions');
            if (suggestionsDiv) suggestionsDiv.classList.remove('active');
            
            // Load content based on mode
            if (searchType === 'predictor') {
                loadPlayerPrediction(player);
            } else if (searchType === 'analysis') {
                loadPlayerAnalysis(player);
            } else if (searchType.startsWith('compare')) {
                if (selectedPlayers.compare1 && selectedPlayers.compare2) {
                    loadPlayerComparison();
                }
            }
        }
        
        function loadPlayerPrediction(player) {
            const content = document.getElementById('predictorContent');
            const prediction = ultraPredictor.getComprehensivePrediction(player);
            const injuryRisk = ultraPredictor.calculateInjuryRisk(player);
            const captainScore = ultraPredictor.getCaptainScore(player);
            const trend = ultraPredictor.getTrendAnalysis(player);
            
            // Generate next 5 gameweek predictions
            const gwPredictions = Array(5).fill(0).map((_, i) => {
                const base = parseFloat(prediction.expectedPoints);
                const variance = parseFloat(prediction.variance);
                const points = Math.max(0, base + (Math.random() - 0.5) * variance * 2);
                return points.toFixed(1);
            });
            
            content.innerHTML = `
                <div class="prediction-result">
                    <h2>${player.name}</h2>
                    <p style="font-size: 1.2rem; margin-bottom: 20px;">${player.team} - ${player.position} - ¬£${player.price}m</p>
                    
                    <div class="prediction-score">
                        ${prediction.expectedPoints}
                    </div>
                    <p style="font-size: 1.1rem;">Expected Points (Next 3 GWs)</p>
                    
                    <div style="margin: 30px 0;">
                        <p style="margin-bottom: 10px;">Confidence Level: ${prediction.confidence}%</p>
                        <div class="confidence-meter">
                            <div class="confidence-fill" style="width: ${prediction.confidence}%;"></div>
                        </div>
                        <p style="font-size: 0.9rem; margin-top: 10px;">Range: ${prediction.min} - ${prediction.max} points</p>
                    </div>
                </div>
                
                <div class="ai-analysis">
                    <div class="ai-header">
                        <div class="ai-icon">ü§ñ</div>
                        <div>
                            <h3 style="color: #1a1a1a; margin-bottom: 5px;">AI Intelligence Report</h3>
                            <p style="color: #666; font-size: 0.95rem;">Advanced machine learning analysis</p>
                        </div>
                    </div>
                    
                    <div class="ai-insights">
                        <div class="insight-item">
                            <div class="insight-icon">üìà</div>
                            <div class="insight-content">
                                <h4>Form Trend</h4>
                                <p>${trend.trend} streak with ${trend.confidence}% confidence. ${trend.projection} trajectory expected.</p>
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <div class="insight-icon">‚ö†Ô∏è</div>
                            <div class="insight-content">
                                <h4>Injury Risk Assessment</h4>
                                <p><span style="color: ${injuryRisk.color}; font-weight: 700;">${injuryRisk.level}</span> risk level (${injuryRisk.score}/100). ${injuryRisk.level === 'High' ? 'Consider backup options.' : 'Safe to start.'}</p>
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <div class="insight-icon">¬©Ô∏è</div>
                            <div class="insight-content">
                                <h4>Captaincy Rating</h4>
                                <p><strong>${captainScore}/10</strong> - ${captainScore > 7 ? 'Excellent captain choice' : captainScore > 5 ? 'Viable captain option' : 'Better options available'}</p>
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <div class="insight-icon">üíé</div>
                            <div class="insight-content">
                                <h4>Differential Potential</h4>
                                <p>${player.ownership < 10 ? 'Hidden gem with ' + player.ownership.toFixed(1) + '% ownership' : 'Template player at ' + player.ownership.toFixed(1) + '% ownership'}</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; padding: 30px; border-radius: 20px; margin-top: 30px;">
                    <h3 style="font-size: 1.5rem; margin-bottom: 20px; color: #1a1a1a;">üìä 5-Week Projection</h3>
                    
                    <div style="display: flex; gap: 15px; justify-content: space-between; margin-bottom: 30px;">
                        ${gwPredictions.map((pts, i) => `
                            <div style="flex: 1; text-align: center; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 20px; border-radius: 15px;">
                                <div style="font-size: 0.9rem; color: #666; margin-bottom: 10px;">GW${25+i}</div>
                                <div style="font-size: 2rem; font-weight: 700; color: #667eea;">${pts}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="background: linear-gradient(135deg, ${trend.trend === 'Hot' ? '#00ff8715' : trend.trend === 'Stable' ? '#667eea15' : '#ff475715'} 0%, ${trend.trend === 'Hot' ? '#00d08415' : trend.trend === 'Stable' ? '#764ba215' : '#ff475715'} 100%); padding: 20px; border-radius: 15px; border: 2px solid ${trend.trend === 'Hot' ? '#00d084' : trend.trend === 'Stable' ? '#667eea' : '#ff4757'};">
                        <h4 style="margin-bottom: 10px; color: #1a1a1a;">üéØ AI Recommendation</h4>
                        <p style="color: #333; line-height: 1.6;">
                            ${trend.trend === 'Hot' 
                                ? `Strong BUY signal! ${player.name} is in exceptional form. Expected ${gwPredictions.reduce((sum, pts) => sum + parseFloat(pts), 0).toFixed(1)} points over next 5 gameweeks. Transfer in immediately.`
                                : trend.trend === 'Stable'
                                ? `HOLD recommendation. ${player.name} showing consistent returns. Monitor for breakout potential. Consider if you need reliability.`
                                : `SELL alert. Form declining with only ${trend.confidence}% recovery confidence. Better alternatives available in this price range.`
                            }
                        </p>
                    </div>
                </div>
            `;
        }
        
        function loadPlayerAnalysis(player) {
            const content = document.getElementById('analysisContent');
            const injuryRisk = ultraPredictor.calculateInjuryRisk(player);
            const captainScore = ultraPredictor.getCaptainScore(player);
            const differentialScore = ultraPredictor.getDifferentialScore(player);
            
            content.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card highlight">
                        <div class="stat-label">Total Points</div>
                        <div class="stat-value">${player.points}</div>
                        <div class="stat-change ${player.transfers_in > player.transfers_out ? 'positive' : 'negative'}">
                            ${player.transfers_in > player.transfers_out ? '‚Üë' : '‚Üì'} ${Math.abs((player.transfers_in - player.transfers_out) / 1000).toFixed(0)}k
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Points/Game</div>
                        <div class="stat-value">${player.ppg}</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Form</div>
                        <div class="stat-value">${player.form.toFixed(1)}</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Ownership</div>
                        <div class="stat-value">${player.ownership.toFixed(1)}%</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Captain Score</div>
                        <div class="stat-value">${captainScore}</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Differential</div>
                        <div class="stat-value">${differentialScore}</div>
                    </div>
                    
                    ${player.position === 'FWD' || player.position === 'MID' ? `
                    <div class="stat-card">
                        <div class="stat-label">Goals</div>
                        <div class="stat-value">${player.goals}</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Assists</div>
                        <div class="stat-value">${player.assists}</div>
                    </div>
                    ` : ''}
                    
                    ${player.position === 'DEF' || player.position === 'GKP' ? `
                    <div class="stat-card">
                        <div class="stat-label">Clean Sheets</div>
                        <div class="stat-value">${player.cleanSheets || 0}</div>
                    </div>
                    ` : ''}
                    
                    <div class="stat-card">
                        <div class="stat-label">Minutes</div>
                        <div class="stat-value">${player.minutes}</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Injury Risk</div>
                        <div class="stat-value" style="font-size: 1.2rem; color: ${injuryRisk.color};">${injuryRisk.level}</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Value</div>
                        <div class="stat-value">${player.value}</div>
                    </div>
                </div>
            `;
        }
        
        function loadPlayerComparison() {
            const player1 = selectedPlayers.compare1;
            const player2 = selectedPlayers.compare2;
            const content = document.getElementById('comparisonContent');
            
            const pred1 = ultraPredictor.getComprehensivePrediction(player1);
            const pred2 = ultraPredictor.getComprehensivePrediction(player2);
            
            const winner = parseFloat(pred1.expectedPoints) > parseFloat(pred2.expectedPoints) ? player1 : player2;
            const winnerPred = winner === player1 ? pred1 : pred2;
            
            content.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 30px; margin-bottom: 30px;">
                    <div style="text-align: center;">
                        <h3>${player1.name}</h3>
                        <p>${player1.team} - ${player1.position}</p>
                        <div style="font-size: 2rem; color: #667eea; margin: 20px 0;">¬£${player1.price}m</div>
                    </div>
                    
                    <div style="display: flex; align-items: center; font-size: 2rem; font-weight: 700; color: #667eea;">VS</div>
                    
                    <div style="text-align: center;">
                        <h3>${player2.name}</h3>
                        <p>${player2.team} - ${player2.position}</p>
                        <div style="font-size: 2rem; color: #667eea; margin: 20px 0;">¬£${player2.price}m</div>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 30px;">
                    <div style="display: grid; gap: 15px;">
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center; padding: 15px; background: white; border-radius: 12px;">
                            <div style="text-align: right; font-size: 1.5rem; font-weight: 700; color: ${parseFloat(pred1.expectedPoints) > parseFloat(pred2.expectedPoints) ? '#00d084' : '#666'};">
                                ${pred1.expectedPoints}
                            </div>
                            <div style="text-align: center; color: #999;">AI Prediction</div>
                            <div style="text-align: left; font-size: 1.5rem; font-weight: 700; color: ${parseFloat(pred2.expectedPoints) > parseFloat(pred1.expectedPoints) ? '#00d084' : '#666'};">
                                ${pred2.expectedPoints}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center; padding: 15px; background: white; border-radius: 12px;">
                            <div style="text-align: right; font-size: 1.3rem; font-weight: 600; color: ${player1.form > player2.form ? '#00d084' : '#666'};">
                                ${player1.form.toFixed(1)}
                            </div>
                            <div style="text-align: center; color: #999;">Form</div>
                            <div style="text-align: left; font-size: 1.3rem; font-weight: 600; color: ${player2.form > player1.form ? '#00d084' : '#666'};">
                                ${player2.form.toFixed(1)}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center; padding: 15px; background: white; border-radius: 12px;">
                            <div style="text-align: right; font-size: 1.3rem; font-weight: 600; color: ${player1.points > player2.points ? '#00d084' : '#666'};">
                                ${player1.points}
                            </div>
                            <div style="text-align: center; color: #999;">Total Points</div>
                            <div style="text-align: left; font-size: 1.3rem; font-weight: 600; color: ${player2.points > player1.points ? '#00d084' : '#666'};">
                                ${player2.points}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 15px; text-align: center;">
                    <h3 style="font-size: 1.8rem; margin-bottom: 15px;">üèÜ AI Winner: ${winner.name}</h3>
                    <p style="font-size: 1.1rem; opacity: 0.95;">
                        Based on comprehensive analysis, ${winner.name} is predicted to score ${Math.abs(parseFloat(pred1.expectedPoints) - parseFloat(pred2.expectedPoints)).toFixed(1)} more points 
                        with ${winnerPred.confidence}% confidence.
                    </p>
                </div>
            `;
        }
        
        function findDifferentials() {
            const content = document.getElementById('differentialContent');
            const position = document.getElementById('positionFilter').value;
            const priceRange = document.getElementById('priceRange').value;
            
            let filtered = allPlayers.filter(p => p.ownership < 15 && p.form > 3);
            
            if (position !== 'all') {
                filtered = filtered.filter(p => p.position === position);
            }
            
            if (priceRange === 'budget') {
                filtered = filtered.filter(p => p.price < 6.0);
            } else if (priceRange === 'mid') {
                filtered = filtered.filter(p => p.price >= 6.0 && p.price <= 9.0);
            } else if (priceRange === 'premium') {
                filtered = filtered.filter(p => p.price > 9.0);
            }
            
            const differentials = filtered
                .map(p => ({
                    ...p,
                    score: ultraPredictor.getDifferentialScore(p)
                }))
                .sort((a, b) => parseFloat(b.score) - parseFloat(a.score))
                .slice(0, 12);
            
            if (differentials.length === 0) {
                content.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 60px; color: #999;">
                        <p style="font-size: 1.2rem;">No differentials found with current filters</p>
                    </div>
                `;
                return;
            }
            
            content.innerHTML = differentials.map((player, index) => `
                <div class="differential-card">
                    <div class="differential-rank">${index + 1}</div>
                    
                    <h3 style="font-size: 1.3rem; margin-bottom: 10px; color: #1a1a1a;">${player.name}</h3>
                    <p style="color: #666; margin-bottom: 15px;">${player.team} - ${player.position}</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                        <div>
                            <span style="color: #999; font-size: 0.85rem;">Price</span>
                            <div style="font-weight: 700; color: #667eea;">¬£${player.price.toFixed(1)}m</div>
                        </div>
                        <div>
                            <span style="color: #999; font-size: 0.85rem;">Ownership</span>
                            <div style="font-weight: 700; color: #00d084;">${player.ownership.toFixed(1)}%</div>
                        </div>
                        <div>
                            <span style="color: #999; font-size: 0.85rem;">Form</span>
                            <div style="font-weight: 700;">${player.form.toFixed(1)}</div>
                        </div>
                        <div>
                            <span style="color: #999; font-size: 0.85rem;">Points</span>
                            <div style="font-weight: 700;">${player.points}</div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 10px; border-radius: 10px; text-align: center;">
                        <span style="color: #666; font-size: 0.85rem;">Differential Score</span>
                        <div style="font-size: 1.5rem; font-weight: 700; color: #667eea;">${player.score}</div>
                    </div>
                </div>
            `).join('');
        }
        
        function findCaptains() {
            const content = document.getElementById('captainContent');
            
            const captainCandidates = allPlayers
                .map(p => ({
                    ...p,
                    captainScore: ultraPredictor.getCaptainScore(p)
                }))
                .sort((a, b) => parseFloat(b.captainScore) - parseFloat(a.captainScore))
                .slice(0, 6);
            
            content.innerHTML = `
                <div style="display: grid; gap: 20px; margin-top: 30px;">
                    ${captainCandidates.map((player, index) => `
                        <div style="background: ${index === 0 ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : 'white'}; 
                                    color: ${index === 0 ? 'white' : '#1a1a1a'}; 
                                    padding: 25px; border-radius: 15px; 
                                    display: flex; justify-content: space-between; align-items: center;
                                    box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                            <div>
                                <h3 style="font-size: 1.5rem; margin-bottom: 5px;">
                                    ${index === 0 ? 'üëë' : index === 1 ? '‚≠ê' : 'üéØ'} ${player.name}
                                </h3>
                                <p style="opacity: ${index === 0 ? '0.95' : '0.7'};">
                                    ${player.team} - ${player.position} - ¬£${player.price.toFixed(1)}m
                                </p>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 2rem; font-weight: 700;">${player.captainScore}/10</div>
                                <p style="font-size: 0.9rem; opacity: ${index === 0 ? '0.95' : '0.7'};">
                                    ${index === 0 ? 'Top Pick' : index === 1 ? 'Vice Captain' : 'Alternative'}
                                </p>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        // Close suggestions when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.player-search')) {
                document.querySelectorAll('.suggestions').forEach(s => s.classList.remove('active'));
            }
        });
    </script>
</body>
</html>