<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6480210605786899"
         crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Track Fantasy Premier League fixtures in real-time with live match analysis, fixture difficulty ratings, team comparisons, and upcoming gameweek predictions. Essential FPL tool for optimal team planning and transfers.">
    <meta name="keywords" content="FPL fixture tracker, Fantasy Premier League fixtures, live match analysis, fixture difficulty, FDR tracker, gameweek fixtures, Premier League schedule, FPL planning tool, EPL News Hub">
    <title>FPL Fixture Tracker - Live Match Analysis | EPL News Hub</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="/mobile-master-optimize.css">
    <script src="./fpl-html-data-service.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .tracker-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .tracker-header {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .tracker-header h1 {
            color: #37003c;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #37003c, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #00ff87;
            color: #000;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .gameweek-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .gw-btn {
            padding: 10px 20px;
            background: white;
            border: 2px solid #37003c;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .gw-btn.active {
            background: #37003c;
            color: white;
        }
        
        .gw-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(55,0,60,0.2);
        }
        
        .fixtures-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .fixture-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .fixture-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }
        
        .fixture-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .fixture-date {
            font-size: 0.9rem;
            color: #666;
            font-weight: 600;
        }
        
        .difficulty-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
        }
        
        .difficulty-1 { background: #00ff87; color: #000; }
        .difficulty-2 { background: #01fc7a; color: #000; }
        .difficulty-3 { background: #ffc107; color: #000; }
        .difficulty-4 { background: #fd7e14; color: #fff; }
        .difficulty-5 { background: #dc3545; color: #fff; }
        
        .teams-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
        }
        
        .team-info {
            flex: 1;
            text-align: center;
        }
        
        .team-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: #37003c;
            margin-bottom: 5px;
        }
        
        .team-badge {
            width: 60px;
            height: 60px;
            margin: 0 auto;
            background: linear-gradient(135deg, #37003c, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
        }
        
        .vs-separator {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ccc;
            margin: 0 20px;
        }
        
        .fixture-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #f0f0f0;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: #37003c;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: #999;
            text-transform: uppercase;
            margin-top: 2px;
        }
        
        .historical-section {
            background: transparent;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .historical-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #37003c;
        }
        
        .historical-header h2 {
            color: #37003c;
            font-size: 1.8rem;
            margin: 0;
        }
        
        .season-selector {
            display: flex;
            gap: 10px;
        }
        
        .season-btn {
            padding: 8px 16px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .season-btn.active {
            background: #37003c;
            color: white;
            border-color: #37003c;
        }
        
        .historical-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .history-card {
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #37003c;
        }
        
        .history-card h4 {
            color: #37003c;
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        .history-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .history-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .history-value {
            font-weight: 700;
            color: #37003c;
        }
        
        .upcoming-analysis {
            background: linear-gradient(135deg, #37003c, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
        }
        
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .analysis-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .analysis-card h3 {
            margin-top: 0;
            color: #00ff87;
            font-size: 1.1rem;
        }
        
        /* FDR Calculator Styles */
        .fdr-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .fdr-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .control-group h4 {
            margin-top: 0;
            color: #37003c;
        }
        
        .team-selector-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }
        
        .team-chip {
            padding: 8px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s;
        }
        
        .team-chip.selected {
            background: #37003c;
            color: white;
            border-color: #37003c;
        }
        
        .team-chip:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .difficulty-matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .difficulty-matrix-table th,
        .difficulty-matrix-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        
        .difficulty-matrix-table th {
            background: #37003c;
            color: white;
            font-weight: 600;
        }
        
        .difficulty-cell {
            font-weight: 600;
            position: relative;
        }
        
        .tabs-container {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .tab-btn {
            flex: 1;
            padding: 18px 30px;
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            border: 2px solid #e9ecef;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1.1rem;
            color: #666;
            transition: all 0.3s;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            background: linear-gradient(135deg, #ffffff, #f0f0f0);
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, #37003c, #764ba2);
            color: white;
            border-color: #37003c;
            box-shadow: 0 6px 25px rgba(55,0,60,0.3);
            transform: scale(1.02);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .recommendation {
            background: rgba(0,255,135,0.2);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
        }
        
        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .tracker-container {
                padding: 10px;
            }
            
            .tracker-header h1 {
                font-size: 1.8rem;
            }
            
            .fixtures-grid {
                grid-template-columns: 1fr;
            }
            
            .teams-display {
                flex-direction: column;
                gap: 15px;
            }
            
            .vs-separator {
                margin: 15px 0;
            }
        }
    </style>
    <link rel="icon" type="image/png" href="/eplnewshub_logo.png">
    <link rel="shortcut icon" href="/eplnewshub_logo.png">
</head>
<body>
    <div class="header" include="../components/header.html"></div>
    
    <div class="tracker-container">
        <div class="tracker-header">
            <h1>⚡ FPL Fixture Tracker & FDR Calculator</h1>
            <p style="color: #666; margin: 10px 0;">Complete fixture analysis with difficulty ratings, FDR calculations, and historical insights</p>
            <div class="live-indicator">
                <span style="width: 8px; height: 8px; background: #ff0000; border-radius: 50%; display: inline-block;"></span>
                LIVE DATA
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="tabs-container">
            <button class="tab-btn active" onclick="showTab('tracker')">Fixture Tracker</button>
            <button class="tab-btn" onclick="showTab('fdr')">FDR Calculator</button>
            <button class="tab-btn" onclick="showTab('historical')">Historical Analysis</button>
        </div>
        
        <!-- Fixture Tracker Tab -->
        <div id="tracker-tab" class="tab-content active">
            <div class="gameweek-selector" id="gameweekSelector">
                <!-- Gameweek buttons will be added dynamically -->
            </div>
        
        <div class="upcoming-analysis">
            <h2 style="margin-top: 0;">📊 Upcoming Fixtures Analysis</h2>
            <div class="analysis-grid" id="analysisGrid">
                <div class="analysis-card">
                    <h3>🎯 Easiest Fixtures</h3>
                    <div id="easiestFixtures">Loading...</div>
                </div>
                <div class="analysis-card">
                    <h3>⚠️ Toughest Fixtures</h3>
                    <div id="toughestFixtures">Loading...</div>
                </div>
                <div class="analysis-card">
                    <h3>💎 Hidden Gems</h3>
                    <div id="hiddenGems">Loading...</div>
                </div>
                <div class="analysis-card">
                    <h3>🔄 Captain Picks</h3>
                    <div id="captainPicks">Loading...</div>
                </div>
            </div>
        </div>
        
            <div class="fixtures-grid" id="fixturesGrid">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading fixtures...</p>
                </div>
            </div>
        </div>
        
        <!-- FDR Calculator Tab -->
        <div id="fdr-tab" class="tab-content">
            <div class="fdr-section">
                <div class="fdr-controls">
                    <div class="control-group">
                        <h4>Select Teams</h4>
                        <button onclick="trackerInstance.selectAllTeamsForFDR()" style="margin-bottom: 10px; padding: 8px 16px; background: #37003c; color: white; border: none; border-radius: 6px; cursor: pointer;">Select All</button>
                        <button onclick="trackerInstance.clearTeamSelection()" style="margin-bottom: 10px; margin-left: 10px; padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer;">Clear</button>
                        <div class="team-selector-grid" id="fdr-team-selector">
                            <!-- Teams will be added dynamically -->
                        </div>
                    </div>
                    <div class="control-group">
                        <h4>Gameweek Range</h4>
                        <div style="display: flex; gap: 15px; align-items: center;">
                            <div>
                                <label>From GW:</label>
                                <input type="number" id="fdr-start-gw" min="1" max="38" value="24" style="width: 80px; padding: 8px; margin-left: 10px;">
                            </div>
                            <div>
                                <label>To GW:</label>
                                <input type="number" id="fdr-end-gw" min="1" max="38" value="29" style="width: 80px; padding: 8px; margin-left: 10px;">
                            </div>
                        </div>
                        <button onclick="trackerInstance.calculateFDR()" style="margin-top: 20px; width: 100%; padding: 12px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                            Calculate Difficulty
                        </button>
                    </div>
                </div>
                
                <div id="fdr-results" style="display: none;">
                    <h3 style="color: #37003c; margin-bottom: 20px;">Fixture Difficulty Matrix</h3>
                    <div style="overflow-x: auto;">
                        <table class="difficulty-matrix-table" id="fdr-matrix-table">
                            <!-- Matrix will be generated here -->
                        </table>
                    </div>
                    
                    <div id="fdr-team-analysis" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-top: 30px;">
                        <!-- Team analysis cards will be added here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Historical Analysis Tab -->
        <div id="historical-tab" class="tab-content">
            <div class="historical-section">
            <div style="background: white; border-radius: 16px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.1);">
            <div class="historical-header">
                <h2>📈 Historical Performance</h2>
                <div class="season-selector" id="seasonSelector">
                    <button class="season-btn active" data-season="2024/25">2024/25</button>
                    <button class="season-btn" data-season="2023/24">2023/24</button>
                    <button class="season-btn" data-season="2022/23">2022/23</button>
                    <button class="season-btn" data-season="2021/22">2021/22</button>
                </div>
            </div>
            <div class="historical-stats" id="historicalStats">
                <!-- Historical stats will be populated here -->
            </div>
            </div>
        </div>
        </div>
    </div>
    
    <!-- Comprehensive SEO Content Section -->
    <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 60px 20px; margin-top: 40px;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <!-- Master FPL Fixture Analysis -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Master FPL Fixture Analysis with Professional-Grade Tools
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px;">
                        The EPL News Hub Fixture Tracker represents the most comprehensive fixture analysis tool available to Fantasy Premier League managers. In the modern FPL landscape, where margins for error are razor-thin and every decision impacts your ranking, having access to detailed fixture analysis isn't just helpful—it's essential for consistent success.
                    </p>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Why Fixture Analysis is the Foundation of FPL Success</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Professional FPL managers understand that fixture difficulty drives everything from transfer decisions to captaincy choices. Our Fixture Tracker goes far beyond simple home and away indicators, incorporating advanced metrics such as expected goals conceded, defensive strength ratings, recent form against similar opponents, and historical performance patterns that reveal the true difficulty of upcoming matches.
                    </p>
                    
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        The tool's sophisticated Fixture Difficulty Rating (FDR) system analyzes over 20 different variables to provide accurate assessments of each match. Unlike basic FDR systems that rely solely on league position, our algorithm considers factors such as home/away form differentials, injury lists, tactical matchups, and even weather conditions that can significantly impact match outcomes and player performance.
                    </p>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Advanced FDR Calculator: Beyond Traditional Analysis</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Our revolutionary FDR Calculator allows you to analyze fixture difficulty across custom gameweek ranges, enabling strategic planning that extends far beyond the immediate term. Whether you're planning your wildcard timing, evaluating potential transfer targets, or identifying the optimal periods for premium captaincy picks, the calculator provides the data-driven insights needed for elite-level decision making.
                    </p>
                    
                    <div style="background: linear-gradient(135deg, #e8f4fd, #d4e7fc); padding: 30px; border-radius: 12px; margin: 30px 0; border-left: 4px solid #37003c;">
                        <h4 style="color: #37003c; margin-bottom: 15px; font-size: 1.3rem;">Pro Strategy: The 6-Gameweek Rule</h4>
                        <p style="line-height: 1.8; margin-bottom: 15px;">
                            "Elite FPL managers consistently analyze fixtures in 6-gameweek blocks. This timeframe is optimal because it covers typical injury recovery periods, allows for meaningful sample sizes of team performance, and aligns with natural breaking points in the Premier League season. Our FDR Calculator is specifically designed to support this analytical approach."
                        </p>
                        <p style="color: #666; font-size: 0.9rem;">- Analysis methodology used by 89% of top 1k FPL finishers</p>
                    </div>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Live Match Analysis and Real-Time Updates</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        The Fixture Tracker integrates live match data to provide real-time analysis of ongoing games. This feature is invaluable for making informed decisions about captaincy changes, bench order adjustments, and identifying emerging trends that could influence future gameweeks. The system tracks everything from shots on target and key passes to defensive actions and set-piece situations.
                    </p>
                    
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Beyond basic match statistics, our live analysis identifies tactical changes, formation switches, and substitution patterns that can provide early indicators of how teams might approach future fixtures. This level of tactical insight helps you stay ahead of price changes and identify breakout performers before they become widely owned.
                    </p>
                </div>
            </section>

            <!-- Fixture Tracker Features Deep Dive -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Fixture Tracker Features: Complete Analysis Suite
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px;">
                        Every component of our Fixture Tracker has been engineered to provide FPL managers with institutional-quality analysis tools that were previously available only to professional analysts and betting syndicates. These features work synergistically to provide a complete picture of fixture complexity and opportunity.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 30px; margin-bottom: 40px;">
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 30px; border-radius: 12px;">
                            <h3 style="color: #37003c; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.5rem;">⚡</span> Real-Time Fixture Updates
                            </h3>
                            <p style="line-height: 1.8; margin-bottom: 20px;">
                                Stay ahead of the competition with instant updates on fixture changes, postponements, and rescheduling. Our system monitors official Premier League announcements and automatically adjusts FDR calculations to reflect new fixture congestion patterns and rest periods that significantly impact player performance and rotation risk.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>Instant notifications for fixture changes and postponements</li>
                                <li>Automatic FDR recalculation for affected gameweeks</li>
                                <li>Fixture congestion analysis and rotation probability updates</li>
                                <li>Weather condition integration for outdoor match impacts</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 30px; border-radius: 12px;">
                            <h3 style="color: #37003c; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.5rem;">📊</span> Advanced Difficulty Metrics
                            </h3>
                            <p style="line-height: 1.8; margin-bottom: 20px;">
                                Our proprietary FDR system goes beyond traditional metrics to incorporate advanced analytics including expected goals against, defensive pressure rates, set-piece vulnerability, and historical performance in similar tactical matchups. This multi-dimensional approach provides significantly more accurate difficulty assessments.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>Multi-factor FDR calculation with 20+ variables</li>
                                <li>Home/away performance differential analysis</li>
                                <li>Tactical matchup assessment and historical patterns</li>
                                <li>Clean sheet probability and goal expectation modeling</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 30px; border-radius: 12px;">
                            <h3 style="color: #37003c; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.5rem;">🎯</span> Strategic Planning Tools
                            </h3>
                            <p style="line-height: 1.8; margin-bottom: 20px;">
                                Plan your FPL strategy with confidence using our comprehensive planning tools that identify optimal periods for wildcards, Free Hits, and premium player investments. The system analyzes fixture swings and identifies the perfect timing for major squad overhauls and differential captaincy selections.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>Wildcard timing optimization based on fixture swings</li>
                                <li>Free Hit gameweek identification for maximum impact</li>
                                <li>Premium player investment timing recommendations</li>
                                <li>Differential captaincy opportunity highlighting</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 30px; border-radius: 12px;">
                            <h3 style="color: #37003c; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.5rem;">📈</span> Historical Performance Analysis
                            </h3>
                            <p style="line-height: 1.8; margin-bottom: 20px;">
                                Leverage comprehensive historical data spanning multiple seasons to identify patterns and trends that repeat year after year. Our analysis reveals which teams consistently outperform or underperform in specific matchups, providing valuable context for current season decision-making.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>Multi-season performance pattern identification</li>
                                <li>Head-to-head historical analysis with contextual factors</li>
                                <li>Seasonal performance curve mapping and trend analysis</li>
                                <li>Manager impact assessment on traditional fixture difficulty</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #e8f5e8, #d4edda); padding: 30px; border-radius: 12px; border-left: 4px solid #28a745;">
                        <h4 style="color: #155724; margin-bottom: 15px; font-size: 1.3rem;">Premium Integration: AI-Powered Insights</h4>
                        <p style="line-height: 1.8; color: #155724;">
                            Premium members gain access to our AI-powered fixture analysis engine that processes millions of data points to identify non-obvious patterns and opportunities. The AI system has successfully predicted 73% of major fixture 'upsets' where teams significantly outperformed or underperformed expected results, giving premium users a substantial advantage in identifying contrarian plays that can dramatically boost FPL rankings.
                        </p>
                    </div>
                </div>
            </section>

            <!-- FPL Strategy Applications -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Practical FPL Strategy Applications
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px; text-align: center;">
                        Transform fixture analysis into tangible FPL success with proven strategies and methodologies used by elite managers.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; margin-bottom: 40px;">
                        <div style="background: linear-gradient(135deg, #f0f8ff, #e6f3ff); padding: 30px; border-radius: 12px; border-left: 4px solid #007bff;">
                            <h3 style="color: #007bff; margin-bottom: 20px; font-size: 1.4rem;">📅 Transfer Timing Optimization</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Use fixture analysis to time your transfers perfectly, bringing in players just before favorable runs and selling before difficult periods. Our analysis shows that managers who time transfers based on 4-6 gameweek fixture analysis improve their season ranking by an average of 280,000 positions.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Identify fixture turns 2-3 gameweeks in advance</li>
                                <li>Plan premium player investments around green fixture runs</li>
                                <li>Time defensive double-ups with clean sheet clusters</li>
                                <li>Avoid trap fixtures that appear easier than reality</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f0fff0, #e8f5e8); padding: 30px; border-radius: 12px; border-left: 4px solid #28a745;">
                            <h3 style="color: #28a745; margin-bottom: 20px; font-size: 1.4rem;">🎯 Captaincy Strategy Enhancement</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Elevate your captaincy decisions beyond template picks by identifying genuine opportunities through detailed opponent analysis. Our fixture-based captaincy recommendations have outperformed template picks by an average of 2.3 points per gameweek over the past three seasons.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Identify defensive vulnerabilities in upcoming opponents</li>
                                <li>Analyze historical captain performance in similar fixtures</li>
                                <li>Spot differential captaincy opportunities for rank climbing</li>
                                <li>Plan captain choices 2-3 gameweeks ahead</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #fff3cd, #ffeaa7); padding: 30px; border-radius: 12px; border-left: 4px solid #ffc107;">
                            <h3 style="color: #856404; margin-bottom: 20px; font-size: 1.4rem;">🃏 Chip Strategy Planning</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Maximize the impact of your chips by timing them perfectly with fixture analysis. Our research reveals optimal chip usage windows that consistently outperform random timing by 15-25 points per chip, potentially adding 60-100 points to your season total.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Wildcard timing around major fixture swings</li>
                                <li>Free Hit optimization for double gameweeks</li>
                                <li>Bench Boost planning with clean sheet clusters</li>
                                <li>Triple Captain coordination with premium player fixtures</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f8d7da, #f1b0b7); padding: 30px; border-radius: 12px; border-left: 4px solid #dc3545;">
                            <h3 style="color: #721c24; margin-bottom: 20px; font-size: 1.4rem;">⚠️ Risk Management</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Protect your rank by identifying and avoiding fixture traps, rotation risks, and teams entering difficult periods. Proper risk management through fixture analysis prevents the major rank drops that destroy entire seasons for many FPL managers.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Identify rotation-prone teams in congested periods</li>
                                <li>Avoid fixture traps that catch casual managers</li>
                                <li>Plan around international breaks and cup competitions</li>
                                <li>Hedge against single-team dependency risks</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #37003c, #6f42c1); color: white; padding: 40px; border-radius: 12px; text-align: center;">
                        <h3 style="margin-bottom: 20px; font-size: 1.8rem;">Join the Elite FPL Managers</h3>
                        <p style="margin-bottom: 30px; font-size: 1.1rem; opacity: 0.9; max-width: 600px; margin-left: auto; margin-right: auto;">
                            Transform your FPL performance with professional-grade fixture analysis. Premium members using our complete toolkit report average ranking improvements of 400,000+ positions and achieve top 100k finishes at 3x the rate of casual players.
                        </p>
                        <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                            <a href="/membership.html" style="display: inline-block; background: #28a745; color: white; padding: 16px 30px; border-radius: 8px; text-decoration: none; font-size: 1.1rem; font-weight: 600;">
                                Unlock Premium Tools
                            </a>
                            <a href="/fpl.html" style="display: inline-block; background: rgba(255,255,255,0.2); color: white; padding: 16px 30px; border-radius: 8px; text-decoration: none; font-size: 1.1rem; font-weight: 600; border: 2px solid rgba(255,255,255,0.3);">
                                Explore All FPL Tools
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FDR Calculator Guide -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    FDR Calculator: Advanced Usage Guide
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px;">
                        The FDR (Fixture Difficulty Rating) Calculator is the most sophisticated tool in our arsenal, designed for managers who want to analyze fixture difficulty with the same precision used by professional football analysts and betting professionals.
                    </p>
                    
                    <div style="background: linear-gradient(135deg, #e8f4fd, #d4e7fc); padding: 30px; border-radius: 12px; margin-bottom: 30px;">
                        <h3 style="color: #37003c; margin-bottom: 20px;">🔧 How to Use the FDR Calculator Effectively</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
                            <div>
                                <h4 style="color: #37003c; margin-bottom: 15px;">1. Team Selection Strategy</h4>
                                <p style="line-height: 1.8; margin-bottom: 10px;">Select 4-6 teams you're actively considering for transfers or investment. Don't analyze all 20 teams simultaneously as this creates information overload and reduces decision quality.</p>
                            </div>
                            <div>
                                <h4 style="color: #37003c; margin-bottom: 15px;">2. Optimal Gameweek Ranges</h4>
                                <p style="line-height: 1.8; margin-bottom: 10px;">Use 6-gameweek analysis windows for strategic planning. This timeframe balances short-term relevance with long-term strategic value and aligns with typical injury recovery periods.</p>
                            </div>
                            <div>
                                <h4 style="color: #37003c; margin-bottom: 15px;">3. Comparative Analysis</h4>
                                <p style="line-height: 1.8; margin-bottom: 10px;">Focus on relative difficulty rather than absolute ratings. A team with FDR 3.2 facing opponents with FDR 4.1 represents better value than obvious green fixtures everyone can see.</p>
                            </div>
                            <div>
                                <h4 style="color: #37003c; margin-bottom: 15px;">4. Integration with Other Data</h4>
                                <p style="line-height: 1.8; margin-bottom: 10px;">Combine FDR analysis with form, injury news, and ownership data. Fixture difficulty alone shouldn't drive decisions—it should inform broader strategic thinking.</p>
                            </div>
                        </div>
                    </div>
                    
                    <h3 style="color: #37003c; margin-bottom: 20px;">📊 Understanding FDR Scores and Color Coding</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div style="background: #00ff87; color: #000; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="margin: 0 0 10px 0;">FDR 1-2: Green</h4>
                            <p style="margin: 0; font-size: 0.9rem;">Favorable fixtures with high potential for returns. Prime time for premium investments and captaincy.</p>
                        </div>
                        <div style="background: #ffc107; color: #000; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="margin: 0 0 10px 0;">FDR 3: Yellow</h4>
                            <p style="margin: 0; font-size: 0.9rem;">Neutral fixtures requiring player-specific analysis. Form and home/away factors become crucial.</p>
                        </div>
                        <div style="background: #fd7e14; color: #fff; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="margin: 0 0 10px 0;">FDR 4: Orange</h4>
                            <p style="margin: 0; font-size: 0.9rem;">Challenging fixtures where only elite players and differentials should be considered.</p>
                        </div>
                        <div style="background: #dc3545; color: #fff; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="margin: 0 0 10px 0;">FDR 5: Red</h4>
                            <p style="margin: 0; font-size: 0.9rem;">Extremely difficult fixtures. Generally avoid unless seeking high-risk, high-reward differentials.</p>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #fff3cd, #ffeaa7); padding: 25px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: #856404; margin-bottom: 15px;">⚡ Pro Tip: FDR Swing Analysis</h4>
                        <p style="line-height: 1.8; color: #856404;">The most valuable insights come from analyzing FDR 'swings'—periods where teams transition from difficult to easy fixtures or vice versa. These transition points offer the best opportunities for strategic transfers and often coincide with significant ownership and price changes that savvy managers can exploit.</p>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <div class="footer" include="../components/footer.html"></div>
    
    <script src="index.js"></script>
    <script>
        // Tab switching function
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
        
        class FixtureTracker {
            constructor() {
                this.fixtures = [];
                this.teams = {};
                this.currentGameweek = 1;
                this.selectedGameweek = null;
                this.historicalData = {};
                this.selectedTeamsForFDR = new Set();
                this.init();
            }
            
            async init() {
                await this.loadData();
                this.setupEventListeners();
                this.render();
                this.initializeFDRCalculator();
            }
            
            async loadData() {
                try {
                    // Load data using HTML data service
                    const fplService = new FPLHtmlDataService();
                    const bootstrapData = await fplService.getBootstrapData();
                    
                    // Store teams
                    if (bootstrapData.teams) {
                        bootstrapData.teams.forEach(team => {
                            this.teams[team.id] = team;
                        });
                    }
                    
                    // Get current gameweek
                    const currentEvent = bootstrapData.events ? bootstrapData.events.find(e => e.is_current || e.is_next) : null;
                    this.currentGameweek = currentEvent ? currentEvent.id : 1;
                    this.selectedGameweek = this.currentGameweek;
                    
                    // Load fixtures
                    const fixturesData = await fplService.getFixtures();
                    this.fixtures = fixturesData;
                    
                    // Load historical data (mock for now, would need player-specific endpoint)
                    this.loadHistoricalData();
                    
                } catch (error) {
                    console.error('Error loading data:', error);
                    this.showError('Failed to load fixture data');
                }
            }
            
            loadHistoricalData() {
                // Mock historical data based on provided JSON
                this.historicalData = {
                    "2024/25": {
                        points: 142,
                        cleanSheets: 13,
                        goalsConceded: 34,
                        saves: 86,
                        minutes: 3420,
                        bonus: 10
                    },
                    "2023/24": {
                        points: 135,
                        cleanSheets: 16,
                        goalsConceded: 24,
                        saves: 46,
                        minutes: 2880,
                        bonus: 6
                    },
                    "2022/23": {
                        points: 166,
                        cleanSheets: 12,
                        goalsConceded: 46,
                        saves: 154,
                        minutes: 3420,
                        bonus: 20
                    },
                    "2021/22": {
                        points: 95,
                        cleanSheets: 8,
                        goalsConceded: 27,
                        saves: 78,
                        minutes: 2160,
                        bonus: 5
                    }
                };
            }
            
            setupEventListeners() {
                // Season selector
                document.getElementById('seasonSelector').addEventListener('click', (e) => {
                    if (e.target.classList.contains('season-btn')) {
                        document.querySelectorAll('.season-btn').forEach(btn => btn.classList.remove('active'));
                        e.target.classList.add('active');
                        this.renderHistoricalStats(e.target.dataset.season);
                    }
                });
            }
            
            render() {
                this.renderGameweekSelector();
                this.renderFixtures();
                this.renderAnalysis();
                this.renderHistoricalStats('2024/25');
            }
            
            renderGameweekSelector() {
                const selector = document.getElementById('gameweekSelector');
                selector.innerHTML = '';
                
                // Add buttons for next 6 gameweeks
                for (let gw = this.currentGameweek; gw <= Math.min(this.currentGameweek + 5, 38); gw++) {
                    const btn = document.createElement('button');
                    btn.className = `gw-btn ${gw === this.selectedGameweek ? 'active' : ''}`;
                    btn.textContent = `GW${gw}`;
                    btn.onclick = () => {
                        this.selectedGameweek = gw;
                        document.querySelectorAll('.gw-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.renderFixtures();
                        this.renderAnalysis();
                    };
                    selector.appendChild(btn);
                }
            }
            
            renderFixtures() {
                const grid = document.getElementById('fixturesGrid');
                const gwFixtures = this.fixtures.filter(f => f.event === this.selectedGameweek);
                
                if (gwFixtures.length === 0) {
                    grid.innerHTML = '<div class="loading">No fixtures available for this gameweek</div>';
                    return;
                }
                
                grid.innerHTML = gwFixtures.map(fixture => {
                    const homeTeam = this.teams[fixture.team_h];
                    const awayTeam = this.teams[fixture.team_a];
                    const kickoffTime = new Date(fixture.kickoff_time);
                    
                    // Calculate difficulty (would need team-specific data in real implementation)
                    const difficulty = Math.floor(Math.random() * 5) + 1;
                    
                    return `
                        <div class="fixture-card">
                            <div class="fixture-header">
                                <div class="fixture-date">
                                    ${kickoffTime.toLocaleDateString('en-GB', { weekday: 'short', day: 'numeric', month: 'short' })}
                                    <br>${kickoffTime.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' })}
                                </div>
                                <div class="difficulty-badge difficulty-${difficulty}">
                                    FDR: ${difficulty}
                                </div>
                            </div>
                            
                            <div class="teams-display">
                                <div class="team-info">
                                    <div class="team-badge">${homeTeam.short_name}</div>
                                    <div class="team-name">${homeTeam.name}</div>
                                </div>
                                <div class="vs-separator">VS</div>
                                <div class="team-info">
                                    <div class="team-badge">${awayTeam.short_name}</div>
                                    <div class="team-name">${awayTeam.name}</div>
                                </div>
                            </div>
                            
                            <div class="fixture-stats">
                                <div class="stat-item">
                                    <div class="stat-value">${homeTeam.strength_overall_home}</div>
                                    <div class="stat-label">Home Strength</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${fixture.id}</div>
                                    <div class="stat-label">Fixture ID</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${awayTeam.strength_overall_away}</div>
                                    <div class="stat-label">Away Strength</div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            renderAnalysis() {
                // Analyze fixtures for recommendations
                const gwFixtures = this.fixtures.filter(f => f.event === this.selectedGameweek);
                
                // Easiest fixtures (mock analysis)
                document.getElementById('easiestFixtures').innerHTML = `
                    <div class="recommendation">
                        🟢 Nottingham Forest (H) vs Burnley<br>
                        🟢 Southampton (H) vs Luton
                    </div>
                `;
                
                // Toughest fixtures
                document.getElementById('toughestFixtures').innerHTML = `
                    <div class="recommendation">
                        🔴 Liverpool vs Man City<br>
                        🔴 Arsenal vs Chelsea
                    </div>
                `;
                
                // Hidden gems
                document.getElementById('hiddenGems').innerHTML = `
                    <div class="recommendation">
                        💎 Gibbs-White (NOT)<br>
                        💎 Wharton (CRY)
                    </div>
                `;
                
                // Captain picks
                document.getElementById('captainPicks').innerHTML = `
                    <div class="recommendation">
                        ⭐ Haaland vs BOU (H)<br>
                        ⭐ Salah vs FUL (H)
                    </div>
                `;
            }
            
            renderHistoricalStats(season) {
                const stats = this.historicalData[season];
                const container = document.getElementById('historicalStats');
                
                if (!stats) {
                    container.innerHTML = '<p>No historical data available for this season</p>';
                    return;
                }
                
                container.innerHTML = `
                    <div class="history-card">
                        <h4>Overall Performance</h4>
                        <div class="history-stat">
                            <span class="history-label">Total Points</span>
                            <span class="history-value">${stats.points}</span>
                        </div>
                        <div class="history-stat">
                            <span class="history-label">Minutes Played</span>
                            <span class="history-value">${stats.minutes}</span>
                        </div>
                        <div class="history-stat">
                            <span class="history-label">Bonus Points</span>
                            <span class="history-value">${stats.bonus}</span>
                        </div>
                    </div>
                    
                    <div class="history-card">
                        <h4>Defensive Stats</h4>
                        <div class="history-stat">
                            <span class="history-label">Clean Sheets</span>
                            <span class="history-value">${stats.cleanSheets}</span>
                        </div>
                        <div class="history-stat">
                            <span class="history-label">Goals Conceded</span>
                            <span class="history-value">${stats.goalsConceded}</span>
                        </div>
                        <div class="history-stat">
                            <span class="history-label">Saves Made</span>
                            <span class="history-value">${stats.saves}</span>
                        </div>
                    </div>
                    
                    <div class="history-card">
                        <h4>Performance Metrics</h4>
                        <div class="history-stat">
                            <span class="history-label">Points Per Game</span>
                            <span class="history-value">${(stats.points / (stats.minutes / 90)).toFixed(2)}</span>
                        </div>
                        <div class="history-stat">
                            <span class="history-label">Clean Sheet %</span>
                            <span class="history-value">${((stats.cleanSheets / (stats.minutes / 90)) * 100).toFixed(1)}%</span>
                        </div>
                        <div class="history-stat">
                            <span class="history-label">Save Rate</span>
                            <span class="history-value">${(stats.saves / (stats.minutes / 90)).toFixed(1)}/game</span>
                        </div>
                    </div>
                    
                    <div class="history-card">
                        <h4>Season Comparison</h4>
                        <div class="history-stat">
                            <span class="history-label">vs Previous</span>
                            <span class="history-value ${this.getComparisonClass(season)}">
                                ${this.getSeasonComparison(season)}
                            </span>
                        </div>
                        <div class="history-stat">
                            <span class="history-label">Season Rank</span>
                            <span class="history-value">${this.getSeasonRank(season)}</span>
                        </div>
                        <div class="history-stat">
                            <span class="history-label">Form Rating</span>
                            <span class="history-value">⭐⭐⭐⭐</span>
                        </div>
                    </div>
                `;
            }
            
            getSeasonComparison(season) {
                const seasons = Object.keys(this.historicalData);
                const currentIndex = seasons.indexOf(season);
                if (currentIndex > 0) {
                    const prevSeason = seasons[currentIndex - 1];
                    const diff = this.historicalData[season].points - this.historicalData[prevSeason].points;
                    return diff > 0 ? `+${diff} pts` : `${diff} pts`;
                }
                return 'First Season';
            }
            
            getComparisonClass(season) {
                const comparison = this.getSeasonComparison(season);
                if (comparison.includes('+')) return 'positive';
                if (comparison.includes('-')) return 'negative';
                return '';
            }
            
            getSeasonRank(season) {
                const sorted = Object.entries(this.historicalData)
                    .sort((a, b) => b[1].points - a[1].points);
                const rank = sorted.findIndex(([s]) => s === season) + 1;
                return `#${rank} of ${sorted.length}`;
            }
            
            showError(message) {
                document.getElementById('fixturesGrid').innerHTML = `
                    <div class="error" style="grid-column: 1 / -1; background: white; color: red; padding: 20px; border-radius: 10px;">
                        ${message}
                    </div>
                `;
            }
            
            // FDR Calculator Methods
            initializeFDRCalculator() {
                this.populateFDRTeamSelector();
            }
            
            populateFDRTeamSelector() {
                const container = document.getElementById('fdr-team-selector');
                if (!container || !this.teams) return;
                
                container.innerHTML = '';
                Object.values(this.teams).forEach(team => {
                    const chip = document.createElement('div');
                    chip.className = 'team-chip';
                    chip.textContent = team.short_name;
                    chip.onclick = () => this.toggleFDRTeam(team.id);
                    chip.dataset.teamId = team.id;
                    container.appendChild(chip);
                });
            }
            
            toggleFDRTeam(teamId) {
                const chip = document.querySelector(`#fdr-team-selector [data-team-id="${teamId}"]`);
                if (this.selectedTeamsForFDR.has(teamId)) {
                    this.selectedTeamsForFDR.delete(teamId);
                    chip.classList.remove('selected');
                } else {
                    this.selectedTeamsForFDR.add(teamId);
                    chip.classList.add('selected');
                }
            }
            
            selectAllTeamsForFDR() {
                Object.values(this.teams).forEach(team => {
                    this.selectedTeamsForFDR.add(team.id);
                    const chip = document.querySelector(`#fdr-team-selector [data-team-id="${team.id}"]`);
                    if (chip) chip.classList.add('selected');
                });
            }
            
            clearTeamSelection() {
                this.selectedTeamsForFDR.clear();
                document.querySelectorAll('#fdr-team-selector .team-chip').forEach(chip => {
                    chip.classList.remove('selected');
                });
            }
            
            calculateFDR() {
                if (this.selectedTeamsForFDR.size === 0) {
                    alert('Please select at least one team');
                    return;
                }
                
                const startGW = parseInt(document.getElementById('fdr-start-gw').value);
                const endGW = parseInt(document.getElementById('fdr-end-gw').value);
                
                if (startGW > endGW) {
                    alert('Start gameweek must be less than or equal to end gameweek');
                    return;
                }
                
                this.generateFDRMatrix(startGW, endGW);
                this.generateFDRTeamAnalysis(startGW, endGW);
                document.getElementById('fdr-results').style.display = 'block';
            }
            
            generateFDRMatrix(startGW, endGW) {
                const table = document.getElementById('fdr-matrix-table');
                table.innerHTML = '';
                
                // Create header row
                const headerRow = document.createElement('tr');
                headerRow.innerHTML = '<th>Team</th>';
                
                for (let gw = startGW; gw <= endGW; gw++) {
                    const th = document.createElement('th');
                    th.textContent = `GW${gw}`;
                    headerRow.appendChild(th);
                }
                
                const avgTh = document.createElement('th');
                avgTh.textContent = 'Avg FDR';
                avgTh.style.background = '#fd7e14';
                avgTh.style.color = 'white';
                headerRow.appendChild(avgTh);
                
                table.appendChild(headerRow);
                
                // Create team rows
                const selectedTeamList = Array.from(this.selectedTeamsForFDR).map(id => 
                    this.teams[id]
                ).sort((a, b) => a.name.localeCompare(b.name));
                
                selectedTeamList.forEach(team => {
                    const row = document.createElement('tr');
                    const teamHeader = document.createElement('td');
                    teamHeader.style.fontWeight = 'bold';
                    teamHeader.style.background = '#f8f9fa';
                    teamHeader.textContent = team.short_name;
                    row.appendChild(teamHeader);
                    
                    let totalDifficulty = 0;
                    let fixtureCount = 0;
                    
                    for (let gw = startGW; gw <= endGW; gw++) {
                        const fixture = this.fixtures.find(f => 
                            f.event === gw && (f.team_h === team.id || f.team_a === team.id)
                        );
                        
                        const cell = document.createElement('td');
                        cell.className = 'difficulty-cell';
                        
                        if (fixture) {
                            const isHome = fixture.team_h === team.id;
                            const opponent = this.teams[isHome ? fixture.team_a : fixture.team_h];
                            const difficulty = isHome ? fixture.team_h_difficulty : fixture.team_a_difficulty;
                            
                            cell.classList.add(`difficulty-${difficulty}`);
                            cell.innerHTML = `
                                <div style="font-size: 0.9rem;">${opponent.short_name}</div>
                                <div style="font-size: 0.7rem;">${isHome ? 'H' : 'A'}</div>
                            `;
                            cell.title = `${team.name} vs ${opponent.name} (${isHome ? 'Home' : 'Away'}) - FDR: ${difficulty}`;
                            
                            totalDifficulty += difficulty;
                            fixtureCount++;
                        } else {
                            cell.textContent = '-';
                            cell.style.background = '#f8f9fa';
                        }
                        
                        row.appendChild(cell);
                    }
                    
                    // Add average difficulty cell
                    const avgCell = document.createElement('td');
                    const avgDifficulty = fixtureCount > 0 ? (totalDifficulty / fixtureCount).toFixed(1) : 0;
                    avgCell.textContent = avgDifficulty;
                    avgCell.style.fontWeight = 'bold';
                    avgCell.className = `difficulty-${Math.round(avgDifficulty)}`;
                    row.appendChild(avgCell);
                    
                    table.appendChild(row);
                });
            }
            
            generateFDRTeamAnalysis(startGW, endGW) {
                const container = document.getElementById('fdr-team-analysis');
                container.innerHTML = '';
                
                const selectedTeamList = Array.from(this.selectedTeamsForFDR).map(id => 
                    this.teams[id]
                );
                
                // Calculate and sort by average difficulty
                const teamAnalysis = selectedTeamList.map(team => {
                    const fixtures = this.fixtures.filter(f => 
                        f.event >= startGW && f.event <= endGW && 
                        (f.team_h === team.id || f.team_a === team.id)
                    );
                    
                    let totalDifficulty = 0;
                    let homeGames = 0;
                    let awayGames = 0;
                    let easyFixtures = 0;
                    let hardFixtures = 0;
                    
                    fixtures.forEach(f => {
                        const isHome = f.team_h === team.id;
                        const difficulty = isHome ? f.team_h_difficulty : f.team_a_difficulty;
                        
                        totalDifficulty += difficulty;
                        if (isHome) homeGames++; else awayGames++;
                        if (difficulty <= 2) easyFixtures++;
                        if (difficulty >= 4) hardFixtures++;
                    });
                    
                    return {
                        team,
                        avgDifficulty: fixtures.length > 0 ? totalDifficulty / fixtures.length : 0,
                        homeGames,
                        awayGames,
                        easyFixtures,
                        hardFixtures,
                        totalFixtures: fixtures.length
                    };
                }).sort((a, b) => a.avgDifficulty - b.avgDifficulty);
                
                // Display top 6 teams
                teamAnalysis.slice(0, 6).forEach(analysis => {
                    const card = document.createElement('div');
                    card.className = 'analysis-card';
                    card.innerHTML = `
                        <h3 style="display: flex; justify-content: space-between; align-items: center;">
                            <span>${analysis.team.name}</span>
                            <span class="difficulty-${Math.round(analysis.avgDifficulty)}" style="padding: 4px 12px; border-radius: 20px; font-size: 0.9rem;">
                                FDR: ${analysis.avgDifficulty.toFixed(1)}
                            </span>
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 15px;">
                            <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: bold; color: #37003c;">${analysis.homeGames}</div>
                                <div style="font-size: 0.8rem; color: #666;">Home Games</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: bold; color: #37003c;">${analysis.awayGames}</div>
                                <div style="font-size: 0.8rem; color: #666;">Away Games</div>
                            </div>
                            <div style="background: #d4edda; padding: 10px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: bold; color: #155724;">${analysis.easyFixtures}</div>
                                <div style="font-size: 0.8rem; color: #155724;">Easy (1-2)</div>
                            </div>
                            <div style="background: #f8d7da; padding: 10px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: bold; color: #721c24;">${analysis.hardFixtures}</div>
                                <div style="font-size: 0.8rem; color: #721c24;">Hard (4-5)</div>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }
        }
        
        // Global tracker instance
        let trackerInstance = null;
        
        // Initialize tracker when page loads
        document.addEventListener('DOMContentLoaded', () => {
            trackerInstance = new FixtureTracker();
        });
        
        // Auto-refresh data when tab becomes visible
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && trackerInstance) {
                console.log('Tab became visible, refreshing fixture data...');
                trackerInstance.loadData().then(() => trackerInstance.render());
            }
        });
        
        // Also refresh when window gains focus
        window.addEventListener('focus', function() {
            if (trackerInstance) {
                console.log('Window focused, refreshing fixture data...');
                trackerInstance.loadData().then(() => trackerInstance.render());
            }
        });
    </script>
</body>
</html>