<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TVPLGM5QY9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-TVPLGM5QY9');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="FPL AI Assistant - Get personalized Fantasy Premier League advice powered by advanced AI. Captain picks, transfer recommendations, and expert strategies.">
    <meta name="keywords" content="FPL AI, fantasy premier league AI, FPL assistant, fantasy football AI, FPL tips, FPL captain picks, FPL transfers">
    <meta name="author" content="EPL News Hub">
    <meta name="robots" content="index, follow">
    <title>FPL AI Assistant | EPL News Hub</title>

    <link rel="canonical" href="https://www.eplnewshub.com/fpl-ai-assistant.html">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --bg-card: #141414;
            --border-color: #222222;
            --border-hover: #333333;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #666666;
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --accent-glow: rgba(99, 102, 241, 0.15);
            --success: #22c55e;
            --user-bubble: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            --ai-bubble: #1e1e1e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--text-primary);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--user-bubble);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 600;
        }

        .logo-text span {
            color: var(--accent-primary);
        }

        .new-chat-btn {
            width: 100%;
            padding: 14px 20px;
            margin-top: 20px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
        }

        .new-chat-btn:hover {
            background: var(--bg-card);
            border-color: var(--border-hover);
        }

        .new-chat-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Quick Actions */
        .quick-actions {
            padding: 20px;
            flex: 1;
            overflow-y: auto;
        }

        .quick-actions h3 {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: 12px;
        }

        .quick-btn {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 8px;
            background: transparent;
            border: 1px solid transparent;
            border-radius: 10px;
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 400;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
            text-align: left;
        }

        .quick-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-color: var(--border-color);
        }

        .quick-btn .icon {
            font-size: 16px;
            width: 24px;
            text-align: center;
        }

        /* Sidebar Footer */
        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-color);
        }

        .sidebar-footer a {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 13px;
            padding: 10px 0;
            transition: color 0.2s;
        }

        .sidebar-footer a:hover {
            color: var(--text-primary);
        }

        /* Main Chat Area */
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
            position: relative;
        }

        .chat-header {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
        }

        .chat-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-title h1 {
            font-size: 16px;
            font-weight: 600;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(34, 197, 94, 0.1);
            border-radius: 20px;
            font-size: 12px;
            color: var(--success);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        .model-badge {
            padding: 6px 12px;
            background: var(--accent-glow);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 20px;
            font-size: 12px;
            color: var(--accent-primary);
            font-weight: 500;
        }

        /* Messages Area */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
        }

        .messages-container::-webkit-scrollbar {
            width: 6px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }

        .welcome-screen {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px;
        }

        .welcome-icon {
            width: 80px;
            height: 80px;
            background: var(--user-bubble);
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin-bottom: 24px;
            box-shadow: 0 20px 40px -10px rgba(99, 102, 241, 0.3);
        }

        .welcome-screen h2 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .welcome-screen p {
            color: var(--text-secondary);
            font-size: 15px;
            max-width: 400px;
            line-height: 1.6;
        }

        .suggestion-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 32px;
            justify-content: center;
            max-width: 600px;
        }

        .suggestion-chip {
            padding: 12px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .suggestion-chip:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-primary);
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        /* Message Bubbles */
        .message {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            max-width: 800px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            flex-direction: row-reverse;
            margin-left: auto;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .message.assistant .message-avatar {
            background: var(--user-bubble);
        }

        .message.user .message-avatar {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
        }

        .message-content {
            flex: 1;
            max-width: 600px;
        }

        .message-bubble {
            padding: 16px 20px;
            border-radius: 16px;
            font-size: 14px;
            line-height: 1.7;
        }

        .message.user .message-bubble {
            background: var(--user-bubble);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.assistant .message-bubble {
            background: var(--ai-bubble);
            border: 1px solid var(--border-color);
            border-bottom-left-radius: 4px;
        }

        .message-bubble strong {
            color: var(--accent-primary);
            font-weight: 600;
        }

        .message-bubble ul, .message-bubble ol {
            margin: 12px 0;
            padding-left: 20px;
        }

        .message-bubble li {
            margin: 8px 0;
        }

        .message-bubble code {
            background: rgba(255,255,255,0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 13px;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: none;
            padding: 16px 20px;
            background: var(--ai-bubble);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            width: fit-content;
            margin-bottom: 24px;
        }

        .typing-indicator.active {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            background: var(--text-muted);
            border-radius: 50%;
            animation: bounce 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-8px); }
        }

        /* Input Area */
        .input-container {
            padding: 20px 24px 24px;
            background: linear-gradient(to top, var(--bg-primary) 80%, transparent);
        }

        .input-wrapper {
            max-width: 800px;
            margin: 0 auto;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 4px;
            display: flex;
            align-items: flex-end;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-wrapper:focus-within {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .chat-input {
            flex: 1;
            padding: 14px 16px;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            resize: none;
            outline: none;
            min-height: 24px;
            max-height: 150px;
            line-height: 1.5;
        }

        .chat-input::placeholder {
            color: var(--text-muted);
        }

        .send-btn {
            width: 44px;
            height: 44px;
            margin: 4px;
            background: var(--user-bubble);
            border: none;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .send-btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .send-btn svg {
            width: 20px;
            height: 20px;
        }

        .input-footer {
            text-align: center;
            margin-top: 12px;
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .chat-header {
                padding: 12px 16px;
            }

            .chat-title h1 {
                font-size: 14px;
            }

            .messages-container {
                padding: 16px;
            }

            .message {
                gap: 12px;
            }

            .message-avatar {
                width: 32px;
                height: 32px;
            }

            .message-bubble {
                padding: 12px 16px;
            }

            .input-container {
                padding: 12px 16px 16px;
            }

            .welcome-screen h2 {
                font-size: 22px;
            }

            .suggestion-chips {
                flex-direction: column;
            }

            .suggestion-chip {
                width: 100%;
            }
        }

        /* Mobile menu button */
        .mobile-menu-btn {
            display: none;
            width: 40px;
            height: 40px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            cursor: pointer;
            align-items: center;
            justify-content: center;
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="/" class="logo">
                    <div class="logo-icon">‚öΩ</div>
                    <div class="logo-text">FPL <span>AI</span></div>
                </a>
                <button class="new-chat-btn" onclick="newChat()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    New Chat
                </button>
            </div>

            <div class="quick-actions">
                <h3>Quick Actions</h3>
                <button class="quick-btn" data-question="Who should I captain this gameweek?">
                    <span class="icon">üëë</span>
                    Captain Pick
                </button>
                <button class="quick-btn" data-question="What transfers should I make this week?">
                    <span class="icon">üîÑ</span>
                    Transfer Advice
                </button>
                <button class="quick-btn" data-question="Who are the best value picks right now?">
                    <span class="icon">üíé</span>
                    Value Picks
                </button>
                <button class="quick-btn" data-question="Which teams have the best fixtures?">
                    <span class="icon">üìÖ</span>
                    Fixture Analysis
                </button>
                <button class="quick-btn" data-question="Who are the best differential picks under 10% ownership?">
                    <span class="icon">üéØ</span>
                    Differentials
                </button>
                <button class="quick-btn" data-question="When should I use my wildcard?">
                    <span class="icon">üÉè</span>
                    Chip Strategy
                </button>
            </div>

            <div class="sidebar-footer">
                <a href="/fpl-premium-hub.html">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    All FPL Tools
                </a>
                <a href="/">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                    EPL News Hub
                </a>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <main class="chat-main">
            <header class="chat-header">
                <div class="chat-title">
                    <button class="mobile-menu-btn">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                    <h1>FPL AI Assistant</h1>
                    <div class="status-badge">
                        <span class="status-dot"></span>
                        Online
                    </div>
                </div>
                <div class="model-badge">Llama 3.3 70B</div>
            </header>

            <div class="messages-container" id="messages-container">
                <div class="welcome-screen" id="welcome-screen">
                    <div class="welcome-icon">ü§ñ</div>
                    <h2>How can I help with your FPL team?</h2>
                    <p>Ask me about captain picks, transfers, player analysis, chip strategy, or any Fantasy Premier League question.</p>
                    <div class="suggestion-chips">
                        <button class="suggestion-chip" data-question="Who should I captain this gameweek?">üëë Captain recommendation</button>
                        <button class="suggestion-chip" data-question="Best premium midfielders to own?">‚≠ê Premium picks</button>
                        <button class="suggestion-chip" data-question="Budget forwards under 7m?">üí∞ Budget options</button>
                        <button class="suggestion-chip" data-question="Should I take a hit this week?">üé≤ Hit analysis</button>
                    </div>
                </div>

                <div id="messages-area"></div>

                <div class="typing-indicator" id="typing-indicator">
                    <span></span><span></span><span></span>
                </div>
            </div>

            <div class="input-container">
                <div class="input-wrapper">
                    <textarea
                        class="chat-input"
                        id="chat-input"
                        placeholder="Ask anything about FPL..."
                        rows="1"
                    ></textarea>
                    <button class="send-btn" id="send-btn" title="Send message">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                        </svg>
                    </button>
                </div>
                <div class="input-footer">Powered by Groq ‚Ä¢ Unlimited conversations</div>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="./supabase-config.js"></script>

    <script>
        // Configuration
        const CONFIG = {
            STORAGE_KEY: 'fpl-ai-history',
            GROQ_MODEL: 'llama-3.3-70b-versatile'
        };

        let GROQ_API_KEY = null;
        let conversationHistory = [];
        let isTyping = false;

        // FPL Context
        const FPL_CONTEXT = `You are an expert Fantasy Premier League (FPL) assistant with deep knowledge of the 2024/25 Premier League season.

Key current season data (2024/25):
- Top performers: Mohamed Salah (Liverpool, ¬£13.0m, top scorer), Erling Haaland (Man City, ¬£15.0m), Cole Palmer (Chelsea, ¬£10.5m), Bryan Mbeumo (Brentford, ¬£7.5m)
- Value picks: Chris Wood (Nottingham Forest, ¬£6.5m), Anthony Gordon (Newcastle, ¬£7.5m), Alexander Isak (Newcastle, ¬£8.5m)
- Teams with good fixtures: Newcastle, Arsenal, Brighton, Bournemouth
- Teams with tough fixtures: Chelsea, Liverpool (European commitments), Man City

Your role:
1. Provide specific, actionable FPL advice
2. Use real player data and current form
3. Consider fixture difficulty and rotation risks
4. Give captain recommendations with reasoning
5. Suggest transfers based on value and upcoming games
6. Explain advanced metrics (xG, xA, ICT) when relevant
7. Be concise but thorough

Format responses with:
- Clear headers using **bold text**
- Bullet points for lists
- Player prices in brackets
- Specific recommendations, not vague suggestions

Always stay focused on FPL and Premier League topics.`;

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            await initSupabase();
            bindEventListeners();
            loadHistory();
        });

        async function initSupabase() {
            try {
                const supabase = window.supabase.createClient(
                    window.SUPABASE_URL,
                    window.SUPABASE_ANON_KEY
                );

                const { data, error } = await supabase
                    .from('api_keys')
                    .select('key_value')
                    .eq('key_name', 'groq_api_key')
                    .single();

                if (data && data.key_value) {
                    GROQ_API_KEY = data.key_value;
                    console.log('API key loaded');
                }
            } catch (err) {
                console.error('Supabase error:', err);
            }
        }

        function bindEventListeners() {
            const input = document.getElementById('chat-input');
            const sendBtn = document.getElementById('send-btn');

            sendBtn.addEventListener('click', sendMessage);

            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            input.addEventListener('input', () => {
                input.style.height = 'auto';
                input.style.height = Math.min(input.scrollHeight, 150) + 'px';
            });

            // Quick action buttons
            document.querySelectorAll('.quick-btn, .suggestion-chip').forEach(btn => {
                btn.addEventListener('click', () => {
                    const question = btn.getAttribute('data-question');
                    if (question) {
                        input.value = question;
                        sendMessage();
                    }
                });
            });
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();

            if (!message || isTyping) return;

            // Hide welcome screen
            const welcome = document.getElementById('welcome-screen');
            if (welcome) welcome.style.display = 'none';

            // Add user message
            addMessage(message, 'user');
            input.value = '';
            input.style.height = 'auto';

            // Show typing
            showTyping();

            try {
                const response = await getAIResponse(message);
                hideTyping();
                addMessage(response, 'assistant');
                saveHistory();
            } catch (error) {
                hideTyping();
                addMessage('Sorry, I encountered an error. Please try again.', 'assistant');
            }
        }

        async function getAIResponse(userMessage) {
            if (!GROQ_API_KEY) {
                return getFallbackResponse(userMessage);
            }

            const messages = [
                { role: 'system', content: FPL_CONTEXT },
                ...conversationHistory.slice(-6).map(msg => ({
                    role: msg.role,
                    content: msg.content
                })),
                { role: 'user', content: userMessage }
            ];

            conversationHistory.push({ role: 'user', content: userMessage });

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${GROQ_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: CONFIG.GROQ_MODEL,
                        messages: messages,
                        temperature: 0.7,
                        max_tokens: 1024
                    })
                });

                if (!response.ok) throw new Error('API error');

                const data = await response.json();
                const aiResponse = data.choices[0].message.content;

                conversationHistory.push({ role: 'assistant', content: aiResponse });
                return aiResponse;

            } catch (error) {
                console.error('API error:', error);
                return getFallbackResponse(userMessage);
            }
        }

        function getFallbackResponse(query) {
            const lowerQuery = query.toLowerCase();

            if (lowerQuery.includes('captain')) {
                return `**Captain Recommendations This Week:**

Based on current form and fixtures:

1. **Mohamed Salah (¬£13.0m)** - Liverpool's talisman remains the top pick with excellent home fixtures. Penalty taker and in tremendous form.

2. **Erling Haaland (¬£15.0m)** - Man City's goal machine. High ownership makes him a safe pick.

3. **Cole Palmer (¬£10.5m)** - Chelsea's main man, on penalties and free kicks.

**Differential Option:** Bryan Mbeumo (¬£7.5m) - Brentford's standout performer with great underlying numbers.`;
            }

            if (lowerQuery.includes('transfer')) {
                return `**Transfer Recommendations:**

**Must-Have Players:**
‚Ä¢ Mohamed Salah (¬£13.0m) - Essential if you don't have him
‚Ä¢ Alexander Isak (¬£8.5m) - Newcastle's main striker, great fixtures

**Value Picks:**
‚Ä¢ Chris Wood (¬£6.5m) - Great budget forward option
‚Ä¢ Anthony Gordon (¬£7.5m) - Newcastle's form player

**Sell Candidates:**
‚Ä¢ Players from teams with tough fixtures
‚Ä¢ Underperforming premiums`;
            }

            return `Thanks for your question! I'm here to help with all things FPL.

**I can help you with:**
‚Ä¢ Captain picks and recommendations
‚Ä¢ Transfer suggestions and planning
‚Ä¢ Player comparisons and analysis
‚Ä¢ Chip strategy (Wildcard, Bench Boost, Triple Captain)
‚Ä¢ Fixture analysis and differential picks

Try asking something specific like "Who should I captain?" or "Best budget midfielders?"`;
        }

        function addMessage(content, role) {
            const messagesArea = document.getElementById('messages-area');

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;

            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = role === 'assistant' ? 'ü§ñ' : 'üë§';

            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';

            const bubble = document.createElement('div');
            bubble.className = 'message-bubble';

            if (role === 'assistant') {
                content = content
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>')
                    .replace(/\n/g, '<br>')
                    .replace(/‚Ä¢ /g, '&bull; ');
                bubble.innerHTML = content;
            } else {
                bubble.textContent = content;
            }

            contentDiv.appendChild(bubble);
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(contentDiv);
            messagesArea.appendChild(messageDiv);

            // Scroll to bottom
            const container = document.getElementById('messages-container');
            container.scrollTop = container.scrollHeight;
        }

        function showTyping() {
            isTyping = true;
            document.getElementById('typing-indicator').classList.add('active');
        }

        function hideTyping() {
            isTyping = false;
            document.getElementById('typing-indicator').classList.remove('active');
        }

        function newChat() {
            document.getElementById('messages-area').innerHTML = '';
            document.getElementById('welcome-screen').style.display = 'flex';
            conversationHistory = [];
            localStorage.removeItem(CONFIG.STORAGE_KEY);
        }

        function loadHistory() {
            const saved = localStorage.getItem(CONFIG.STORAGE_KEY);
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    if (data.messages && data.messages.length > 0) {
                        document.getElementById('welcome-screen').style.display = 'none';
                        data.messages.forEach(msg => addMessage(msg.content, msg.role));
                        conversationHistory = data.messages;
                    }
                } catch (e) {}
            }
        }

        function saveHistory() {
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify({
                messages: conversationHistory.slice(-20)
            }));
        }
    </script>
</body>
</html>
