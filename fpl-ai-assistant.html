<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free AI Assistant - Your Open Source AI Helper | EPL News Hub</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Get intelligent help with any question using our free, open source AI assistant. Programming, science, creative writing, general knowledge, and more. No API keys required!">
    <meta name="keywords" content="Free AI Assistant, Open Source AI, Programming Help, Science Questions, Creative Writing, General Knowledge">
    <meta name="author" content="EPL News Hub">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Free AI Assistant - Your Open Source AI Helper">
    <meta property="og:description" content="Get intelligent help with any question using our free, open source AI assistant. Programming, science, creative writing, and more.">
    <meta property="og:image" content="/upscalemedia-transformed.png">
    <meta property="og:url" content="https://eplnewshub.com/fpl-ai-assistant.html">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free AI Assistant - Your Open Source AI Helper">
    <meta name="twitter:description" content="Get intelligent help with any question using our free, open source AI assistant. Programming, science, and more.">
    <meta name="twitter:image" content="/upscalemedia-transformed.png">
    
    <!-- Site Styles -->
    <link rel="stylesheet" href="/styles.css">
    
    <style>
        /* Page-specific styles */
        .ai-assistant-hero {
            background: linear-gradient(135deg, #38003c 0%, #00ff87 100%);
            padding: 40px 0;
            margin: 20px 0;
            border-radius: 20px;
            text-align: center;
            color: white;
        }
        
        .ai-assistant-hero h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 800;
        }
        
        .ai-assistant-hero p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .page-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .chat-container {
            width: 100%;
            max-width: 900px;
            height: 70vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(56, 0, 60, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            margin: 20px auto;
        }
        
        .chat-header {
            background: linear-gradient(135deg, #38003c, #00ff87);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        .chat-header h2 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            font-weight: 700;
        }
        
        .chat-header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }
        
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: #38003c;
            color: white;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-1px);
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }
        
        .message {
            margin-bottom: 20px;
            display: flex;
            gap: 12px;
            animation: fadeIn 0.3s ease-in;
        }
        
        .user-message {
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        .user-avatar {
            background: #6b7280;
        }
        
        .ai-avatar {
            background: linear-gradient(135deg, #38003c, #00ff87);
        }
        
        .message-content {
            max-width: 75%;
            padding: 15px 20px;
            border-radius: 18px;
            line-height: 1.6;
        }
        
        .user-message .message-content {
            background: #38003c;
            color: white;
        }
        
        .ai-message .message-content {
            background: white;
            color: #1f2937;
            border: 1px solid #e5e7eb;
        }
        
        .thinking-indicator {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .thinking-content {
            background: #f3f4f6;
            padding: 15px 20px;
            border-radius: 18px;
            color: #6b7280;
            font-style: italic;
            max-width: 70%;
        }
        
        .thinking-dots {
            display: inline-flex;
            gap: 4px;
            margin-left: 10px;
        }
        
        .thinking-dots span {
            width: 6px;
            height: 6px;
            background: #38003c;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out;
        }
        
        .thinking-dots span:nth-child(1) { animation-delay: -0.32s; }
        .thinking-dots span:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .chat-input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }
        
        .input-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .chat-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .chat-input:focus {
            border-color: #38003c;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .send-button {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            font-size: 1.2rem;
        }
        
        .send-button {
            background: linear-gradient(135deg, #38003c, #00ff87);
            color: white;
        }
        
        
        .send-button:hover {
            transform: scale(1.05);
        }
        
        .send-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        
        .fpl-stats {
            background: #f8f9fa;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            font-size: 0.9rem;
        }
        
        .knowledge-indicator {
            background: #ecfdf5;
            border: 1px solid #d1fae5;
            color: #065f46;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 8px 0;
            font-size: 0.85rem;
        }
        
        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .chat-container {
                width: 95%;
                height: 95vh;
                border-radius: 15px;
            }
            
            .message-content {
                max-width: 85%;
            }
            
            .chat-header h1 {
                font-size: 1.5rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header" include="./header.html"></div>
    
    <!-- Main Content -->
    <main class="page-container">
        <div class="ai-assistant-hero">
            <h1>🤖 Free AI Assistant</h1>
            <p>Your intelligent helper powered by free, open source AI - no setup required!</p>
        </div>
        
        <div class="chat-container">
            <div class="chat-header">
                <h2>🤖 Free AI Assistant</h2>
                <p>Powered by open source AI models - completely free to use</p>
            </div>
        
        
        <div id="chatMessages" class="chat-messages">
            <!-- Messages will be added here -->
        </div>
        
        <div class="chat-input-container">
            <div class="input-wrapper">
                <input type="text" id="userInput" placeholder="Ask me anything..." class="chat-input" autocomplete="off">
            </div>
            <div class="action-buttons">
                <button id="configButton" onclick="showAPIConfig()" class="btn btn-secondary" aria-label="Configure API">
                    ⚙️
                </button>
                <button id="sendButton" onclick="sendMessage()" class="send-button" aria-label="Send Message">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M2 21L23 12L2 3V10L17 12L2 14V21Z" fill="currentColor"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- API Configuration Modal -->
        <div id="apiModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%;">
                <h3 style="margin-top: 0; color: #38003c;">🔑 Configure ChatGPT Integration</h3>
                <p style="color: #6b7280; margin-bottom: 20px;">Enter your OpenAI API key to enable ChatGPT responses. Your key is stored locally and never shared.</p>
                
                <div style="margin-bottom: 15px;">
                    <label for="apiKeyInput" style="display: block; margin-bottom: 5px; font-weight: 600;">OpenAI API Key:</label>
                    <input type="password" id="apiKeyInput" placeholder="sk-..." style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-family: monospace;">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label for="modelSelect" style="display: block; margin-bottom: 5px; font-weight: 600;">Model:</label>
                    <select id="modelSelect" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Recommended)</option>
                        <option value="gpt-4">GPT-4 (Higher Quality, More Expensive)</option>
                        <option value="gpt-4-turbo-preview">GPT-4 Turbo</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="hideAPIConfig()" class="btn btn-secondary">Cancel</button>
                    <button onclick="saveAPIConfig()" class="btn btn-primary">Save Configuration</button>
                </div>
                
                <div style="margin-top: 15px; padding: 10px; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 6px; font-size: 0.9rem; color: #166534;">
                    <strong>💡 Note:</strong> Get your API key from <a href="https://platform.openai.com/account/api-keys" target="_blank" style="color: #166534;">OpenAI's platform</a>. Your key is stored securely in your browser.
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <div class="footer" include="./footer.html"></div>
    
    <!-- Site Scripts -->
    <script src="/index.js"></script>
    
    <script>
        let isTyping = false;
        let messageCount = 0;
        
        // Initialize chat
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved settings
            const savedModel = localStorage.getItem('chatgpt_model');
            if (savedModel) {
                AI_CONFIG.CHATGPT_MODEL = savedModel;
            }
            
            showWelcomeMessage();
            
            // Handle Enter key
            document.getElementById('userInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // Close modal when clicking outside
            document.getElementById('apiModal').addEventListener('click', (e) => {
                if (e.target.id === 'apiModal') {
                    hideAPIConfig();
                }
            });
        });
        
        
        
        
        
        
        
        
        function showWelcomeMessage() {
            setTimeout(() => {
                const hasApiKey = AI_CONFIG.OPENAI_API_KEY ? true : false;
                const aiProvider = hasApiKey ? 'ChatGPT' : 'Free Open Source AI Models';
                
                const message = `🤖 **Welcome to your AI Assistant!**

I'm your **AI Assistant** - ready to help with any question! I can assist with:

**🌐 My Capabilities:**
• **Programming & Coding** - Debug, explain, write code in any language
• **Science & Math** - Explain concepts, solve problems, research topics
• **Creative Writing** - Stories, essays, poems, brainstorming ideas
• **Learning & Education** - Explanations, tutorials, homework help
• **Analysis & Research** - Data analysis, report writing, fact-checking
• **Problem Solving** - Strategic thinking, decision support

**💪 Current Configuration:**
• **AI Provider:** ${aiProvider}
• **Privacy Focused** - Your conversations stay private
• **Multi-topic Help** - Science, technology, humanities, arts
${hasApiKey ? '• **ChatGPT Enabled** - High-quality responses via OpenAI API' : '• **Free Models** - Using Hugging Face\'s open source models'}

${hasApiKey ? '🤖 **Powered by:** ChatGPT (OpenAI)' : '🤖 **Powered by:** Free Open Source AI Models'}
⚡ **Ready for:** Any question, any topic, any challenge!

${!hasApiKey ? '💡 **Want better responses?** Click the ⚙️ button to configure ChatGPT integration!' : ''}

Ask me about **anything** - I'm here to help with whatever you're curious about!`;
                
                displayAIMessage(message);
            }, 500);
        }

        function showAPIConfig() {
            document.getElementById('apiModal').style.display = 'block';
            
            // Pre-fill current settings
            const apiKeyInput = document.getElementById('apiKeyInput');
            const modelSelect = document.getElementById('modelSelect');
            
            if (AI_CONFIG.OPENAI_API_KEY) {
                apiKeyInput.value = AI_CONFIG.OPENAI_API_KEY;
            }
            modelSelect.value = AI_CONFIG.CHATGPT_MODEL;
        }

        function hideAPIConfig() {
            document.getElementById('apiModal').style.display = 'none';
        }

        function saveAPIConfig() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            const model = document.getElementById('modelSelect').value;
            
            if (apiKey) {
                setOpenAIKey(apiKey);
                AI_CONFIG.CHATGPT_MODEL = model;
                localStorage.setItem('chatgpt_model', model);
                
                displayAIMessage(`✅ **Configuration Saved!**\n\nChatGPT integration is now enabled with model: **${model}**\n\nYour API key has been stored locally and will be used for all future conversations. You'll now get high-quality responses powered by OpenAI!`);
            } else {
                // Remove API key to use free models
                localStorage.removeItem('openai_api_key');
                AI_CONFIG.OPENAI_API_KEY = '';
                
                displayAIMessage(`✅ **Configuration Updated!**\n\nSwitched back to **free open source models**. No API key required!\n\nYour conversations will now use Hugging Face's free AI models.`);
            }
            
            hideAPIConfig();
        }
        
        async function sendMessage() {
            if (isTyping) return;
            
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Rate limiting
            if (messageCount >= 20) {
                displayErrorMessage('Rate limit reached. Please refresh the page to continue.');
                return;
            }
            
            messageCount++;
            
            // Display user message
            displayUserMessage(message);
            
            // Clear input
            input.value = '';
            
            // Disable send button
            toggleSendButton(false);
            
            // Show thinking and get AI response
            await getAIResponse(message);
            
            // Re-enable send button
            toggleSendButton(true);
        }
        
        function displayUserMessage(message) {
            const messagesDiv = document.getElementById('chatMessages');
            const msgDiv = document.createElement('div');
            msgDiv.className = 'message user-message';
            msgDiv.innerHTML = `
                <div class="message-content">${escapeHtml(message)}</div>
                <div class="message-avatar user-avatar">👤</div>
            `;
            messagesDiv.appendChild(msgDiv);
            scrollToBottom();
        }
        
        function displayAIMessage(message) {
            const messagesDiv = document.getElementById('chatMessages');
            const msgDiv = document.createElement('div');
            msgDiv.className = 'message ai-message';
            
            msgDiv.innerHTML = `
                <div class="message-avatar ai-avatar">🤖</div>
                <div class="message-content">${formatMessage(message)}</div>
            `;
            messagesDiv.appendChild(msgDiv);
            scrollToBottom();
        }
        
        function displayErrorMessage(errorText) {
            const messagesDiv = document.getElementById('chatMessages');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = errorText;
            messagesDiv.appendChild(errorDiv);
            scrollToBottom();
        }
        
        async function getAIResponse(message) {
            // Show thinking indicator
            showThinking();
            
            try {
                // Get AI response
                const response = await queryFreeAI(message);
                
                // Remove thinking indicator
                removeThinking();
                
                // Display response
                displayAIMessage(response);
                
            } catch (error) {
                console.error('AI error:', error);
                removeThinking();
                
                // Show specific error for API key issues
                if (error.message.includes('API key') || error.message.includes('authentication')) {
                    displayAIMessage('🔑 **API Key Error**\n\nYour OpenAI API key appears to be invalid or missing. Please click the ⚙️ button to configure your API key, or the system will automatically fall back to free models.');
                } else if (error.message.includes('quota') || error.message.includes('billing')) {
                    displayAIMessage('💳 **Quota Exceeded**\n\nYour OpenAI API quota has been exceeded. The system will fall back to free open source models for now. You can add billing to your OpenAI account or continue using the free models.');
                } else {
                    displayAIMessage('⚠️ **Service Error**\n\nSorry, I encountered an error with the AI service. The system will automatically try backup models. Please try again in a moment.');
                }
            }
        }
        
        
        
        
        
        // Configuration for AI services
        const AI_CONFIG = {
            // Set your OpenAI API key here or use localStorage
            OPENAI_API_KEY: localStorage.getItem('openai_api_key') || '',
            CHATGPT_MODEL: 'gpt-3.5-turbo', // or 'gpt-4' for better responses
            USE_CHATGPT: true // Set to false to use Hugging Face models instead
        };

        // Function to set API key
        function setOpenAIKey(apiKey) {
            localStorage.setItem('openai_api_key', apiKey);
            AI_CONFIG.OPENAI_API_KEY = apiKey;
        }

        async function queryFreeAI(query) {
            try {
                // Try ChatGPT first if configured
                if (AI_CONFIG.USE_CHATGPT && AI_CONFIG.OPENAI_API_KEY) {
                    try {
                        const response = await queryOpenAI(query);
                        if (response) return response;
                    } catch (error) {
                        console.log('ChatGPT failed, falling back to Hugging Face:', error.message);
                    }
                }
                
                // Try multiple free Hugging Face models as fallback
                const models = [
                    'microsoft/DialoGPT-medium',
                    'facebook/blenderbot-400M-distill',
                    'microsoft/DialoGPT-small',
                    'google/flan-t5-base'
                ];
                
                for (const model of models) {
                    try {
                        const response = await fetch(`https://api-inference.huggingface.co/models/${model}`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                inputs: query,
                                parameters: {
                                    max_length: 200,
                                    temperature: 0.7,
                                    do_sample: true,
                                    top_p: 0.9
                                },
                                options: {
                                    wait_for_model: true
                                }
                            })
                        });
                        
                        if (response.ok) {
                            const data = await response.json();
                            if (data && data.length > 0 && data[0].generated_text) {
                                let aiResponse = data[0].generated_text.trim();
                                // Clean up the response - remove the original query if it's included
                                aiResponse = aiResponse.replace(query, '').trim();
                                if (aiResponse.length > 10) {
                                    return aiResponse;
                                }
                            }
                        }
                    } catch (error) {
                        console.log(`Model ${model} failed:`, error.message);
                        continue; // Try next model
                    }
                }
                
                // Try a simple text generation approach with GPT-2
                try {
                    const response = await fetch('https://api-inference.huggingface.co/models/gpt2', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            inputs: `Question: ${query}\nAnswer:`,
                            parameters: {
                                max_length: 150,
                                temperature: 0.7,
                                do_sample: true,
                                top_p: 0.9,
                                stop: ["\n\n", "Question:", "Q:"]
                            },
                            options: {
                                wait_for_model: true
                            }
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.length > 0 && data[0].generated_text) {
                            let aiResponse = data[0].generated_text.trim();
                            // Extract just the answer part
                            const answerMatch = aiResponse.match(/Answer:\s*(.+)/s);
                            if (answerMatch) {
                                aiResponse = answerMatch[1].trim();
                            }
                            if (aiResponse.length > 10) {
                                return aiResponse;
                            }
                        }
                    }
                } catch (error) {
                    console.log('GPT-2 fallback failed:', error.message);
                }
                
                // Final intelligent fallback based on question type
                return generateIntelligentResponse(query);
                
            } catch (error) {
                console.error('All AI services failed:', error);
                return generateIntelligentResponse(query);
            }
        }

        async function queryOpenAI(query) {
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${AI_CONFIG.OPENAI_API_KEY}`
                },
                body: JSON.stringify({
                    model: AI_CONFIG.CHATGPT_MODEL,
                    messages: [
                        {
                            role: 'system',
                            content: 'You are a helpful AI assistant specialized in Fantasy Premier League (FPL) advice, football analysis, and general knowledge. Provide clear, concise, and actionable responses.'
                        },
                        {
                            role: 'user',
                            content: query
                        }
                    ],
                    max_tokens: 500,
                    temperature: 0.7
                })
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(`OpenAI API error: ${errorData.error?.message || 'Unknown error'}`);
            }

            const data = await response.json();
            return data.choices[0]?.message?.content?.trim() || null;
        }
        
        function generateIntelligentResponse(query) {
            const lowerQuery = query.toLowerCase();
            
            // Analyze the question and provide helpful responses
            if (lowerQuery.includes('code') || lowerQuery.includes('programming') || lowerQuery.includes('javascript') || lowerQuery.includes('python')) {
                return `🔧 **Programming Help**\n\nFor your coding question about "${query}", here are some general guidelines:\n\n• **Break down the problem** - Start with small, manageable pieces\n• **Check documentation** - Official docs often have the best examples\n• **Use debugging tools** - Console logs, debuggers, and error messages\n• **Test incrementally** - Make small changes and test frequently\n\nFor specific programming questions, I recommend:\n- Stack Overflow for community solutions\n- Official documentation for your language/framework\n- GitHub repositories for code examples\n\nWould you like me to help you break down your specific coding problem?`;
            }
            
            if (lowerQuery.includes('science') || lowerQuery.includes('physics') || lowerQuery.includes('chemistry') || lowerQuery.includes('biology')) {
                return `🔬 **Science Explanation**\n\nRegarding your science question: "${query}"\n\nScience topics often involve:\n• **Observation** - What can we see or measure?\n• **Hypothesis** - What do we think is happening?\n• **Experimentation** - How can we test our ideas?\n• **Analysis** - What do the results tell us?\n\nFor reliable scientific information, I recommend:\n- Khan Academy for educational content\n- NASA, NIH, or other official science organizations\n- Peer-reviewed scientific journals\n- University educational resources\n\nWhat specific aspect of this topic interests you most?`;
            }
            
            if (lowerQuery.includes('math') || lowerQuery.includes('calculate') || lowerQuery.includes('equation')) {
                return `📊 **Math Problem Solving**\n\nFor your math question: "${query}"\n\nMath problem-solving approach:\n• **Understand the problem** - What are we looking for?\n• **Identify given information** - What do we know?\n• **Choose a strategy** - Which method fits best?\n• **Solve step by step** - Show your work\n• **Check your answer** - Does it make sense?\n\nUseful math resources:\n- Wolfram Alpha for calculations\n- Khan Academy for explanations\n- Desmos for graphing\n- Paul's Online Math Notes for advanced topics\n\nWould you like help breaking down your specific math problem?`;
            }
            
            if (lowerQuery.includes('write') || lowerQuery.includes('story') || lowerQuery.includes('creative') || lowerQuery.includes('essay')) {
                return `✍️ **Writing Assistance**\n\nFor your writing question: "${query}"\n\nGood writing involves:\n• **Planning** - Outline your main points\n• **Structure** - Organize ideas logically\n• **Clarity** - Use clear, concise language\n• **Revision** - Edit and improve your work\n• **Voice** - Develop your unique style\n\nWriting resources:\n- Grammarly for grammar and style\n- Hemingway Editor for clarity\n- Writing communities for feedback\n- Reading widely in your genre\n\nWhat type of writing project are you working on?`;
            }
            
            // General helpful response
            return `🤖 **AI Assistant Response**\n\nThank you for your question: "${query}"\n\nI'm a free, open-source AI assistant designed to help with various topics. While I may not have access to the latest AI models right now, I can still provide guidance on:\n\n• **General problem-solving approaches**\n• **Resource recommendations**\n• **Breaking down complex questions**\n• **Suggesting next steps**\n\n**For the best AI responses, try:**\n- ChatGPT, Claude, or Gemini for advanced AI chat\n- Hugging Face Spaces for specialized AI tools\n- Local AI models like Ollama for privacy\n\nWould you like me to help you find the right resources for your specific question, or would you like to rephrase your question in a different way?`;
        }
        
        
        
        function showThinking() {
            isTyping = true;
            const messagesDiv = document.getElementById('chatMessages');
            const thinkingDiv = document.createElement('div');
            thinkingDiv.className = 'thinking-indicator';
            thinkingDiv.id = 'thinkingIndicator';
            
            const thoughts = [
                "🤖 Processing your question...",
                "🎯 AI analyzing your request...",
                "📊 Generating helpful response...",
                "🧭 Thinking through the problem...",
                "🔍 Searching for relevant information...",
                "💡 Preparing intelligent answer..."
            ];
            const thought = thoughts[Math.floor(Math.random() * thoughts.length)];
            
            thinkingDiv.innerHTML = `
                <div class="message-avatar ai-avatar">🤖</div>
                <div class="thinking-content">
                    ${thought}
                    <div class="thinking-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            `;
            
            messagesDiv.appendChild(thinkingDiv);
            scrollToBottom();
        }
        
        function showThinkingWithSearch() {
            isTyping = true;
            const messagesDiv = document.getElementById('chatMessages');
            const thinkingDiv = document.createElement('div');
            thinkingDiv.className = 'thinking-indicator';
            thinkingDiv.id = 'thinkingIndicator';
            
            thinkingDiv.innerHTML = `
                <div class="message-avatar ai-avatar">🤖</div>
                <div class="thinking-content">
                    🔍 Processing your question with AI models...
                    <div class="thinking-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            `;
            
            messagesDiv.appendChild(thinkingDiv);
            scrollToBottom();
            
            // Update to show Llama AI processing after search
            setTimeout(() => {
                thinkingDiv.innerHTML = `
                    <div class="message-avatar ai-avatar">🤖</div>
                    <div class="thinking-content">
                        🤖 Free AI analyzing information + generating response...
                        <div class="thinking-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                `;
            }, 2000);
        }
        
        function removeThinking() {
            const indicator = document.getElementById('thinkingIndicator');
            if (indicator) {
                indicator.remove();
            }
            isTyping = false;
        }
        
        function toggleSendButton(enabled) {
            const sendButton = document.getElementById('sendButton');
            sendButton.disabled = !enabled;
        }
        
        function formatMessage(message) {
            return message
                .replace(/\n/g, '<br>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`(.*?)`/g, '<code style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px;">$1</code>')
                .replace(/• /g, '• ');
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function scrollToBottom() {
            const messagesDiv = document.getElementById('chatMessages');
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        // Add example FPL questions
        function addFPLExamples() {
            setTimeout(() => {
                const examples = [
                    "Explain quantum physics simply",
                    "Help me debug JavaScript code",
                    "Write a short story about space",
                    "Best Python libraries for AI?",
                    "How do I learn machine learning?",
                    "Explain blockchain technology"
                ];
                
                const messagesDiv = document.getElementById('chatMessages');
                const exampleDiv = document.createElement('div');
                exampleDiv.className = 'message ai-message';
                exampleDiv.innerHTML = `
                    <div class="message-avatar ai-avatar">🤖</div>
                    <div class="message-content">
                        <p><strong>Try these questions (any topic!):</strong></p>
                        <div style="margin-top: 15px; display: flex; flex-wrap: wrap; gap: 8px;">
                            ${examples.map(ex => `
                                <button onclick="askExample('${ex}')" style="
                                    background: #f0fdf4; 
                                    border: 1px solid #bbf7d0; 
                                    border-radius: 20px; 
                                    padding: 8px 16px; 
                                    font-size: 0.9rem; 
                                    cursor: pointer;
                                    transition: all 0.2s;
                                    color: #166534;
                                " onmouseover="this.style.background='#dcfce7'" onmouseout="this.style.background='#f0fdf4'">
                                    ${ex}
                                </button>
                            `).join('')}
                        </div>
                        <p style="margin-top: 15px; font-size: 0.9rem; color: #6b7280;">
                            💡 <strong>Pro tip:</strong> I'm completely free and use open source AI models - no setup required!
                        </p>
                    </div>
                `;
                messagesDiv.appendChild(exampleDiv);
                scrollToBottom();
            }, 2000);
        }
        
        function askExample(question) {
            document.getElementById('userInput').value = question;
            sendMessage();
        }
        
        // Add FPL examples after welcome
        setTimeout(addFPLExamples, 1000);
    </script>
    
    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX');
    </script>
</body>
</html>