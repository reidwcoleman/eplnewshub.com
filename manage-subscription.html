<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Manage your EPL News Hub subscription - Update payment methods, change subscription plans, view billing history, and control your premium access to exclusive Premier League content and FPL tools.">
    <meta name="keywords" content="manage subscription, EPL News Hub subscription, payment settings, billing management, premium membership, subscription plans, account management, Premier League subscription">
    <title>Manage Subscription - EPL News Hub</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dark-mode.css">
    <link rel="stylesheet" href="/mobile-master-optimize.css">
    <style>
        body {
            font-family: Georgia, serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #fff;
            color: #000;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #000;
            text-decoration: none;
        }
        .subscription-form {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="email"], input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-primary:hover {
            background-color: #0056b3;
        }
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        .btn-success:hover {
            background-color: #1e7e34;
        }
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        .message {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
        }
        .success-message {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error-message {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .info-message {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        .subscription-status {
            background: #e9ecef;
            padding: 20px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .status-indicator {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
        }
        .subscribed {
            color: #28a745;
        }
        .not-subscribed {
            color: #dc3545;
        }
        .back-link {
            text-align: center;
            margin-top: 20px;
        }
        .back-link a {
            color: #007bff;
            text-decoration: none;
        }
        .back-link a:hover {
            text-decoration: underline;
        }
        .action-buttons {
            display: none;
        }
        .loading {
            text-align: center;
            color: #6c757d;
            font-style: italic;
        }
    </style>
    <script src="dark-mode.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/" class="logo">EPL News Hub</a>
            <h1>Manage Your Subscription</h1>
            <p>Check your subscription status and manage your newsletter preferences and premium memberships.</p>
        </div>

        <div class="subscription-form">
            <div id="messages"></div>

            <!-- Premium Subscription Management -->
            <div id="premiumSection" style="margin-bottom: 30px; padding: 20px; background: #e8f4f8; border-radius: 8px; border-left: 4px solid #37003c;">
                <h3 style="color: #37003c; margin-top: 0;">üèÜ Premium Subscription Management</h3>
                <p>For premium subscription management (Starter, Pro plans), please contact our support team or use Stripe's secure customer portal:</p>
                <div style="margin: 15px 0;">
                    <button type="button" id="contactSupport" class="btn btn-primary" style="margin-right: 10px;">Contact Support</button>
                    <button type="button" id="cancelSubscription" class="btn btn-danger" style="margin-right: 10px;">Cancel Subscription</button>
                    <a href="/membership.html" class="btn btn-success">View Premium Plans</a>
                </div>
                <p><small><strong>Note:</strong> Premium subscription billing, cancellation, and plan changes are handled through Stripe's secure platform for your security.</small></p>
            </div>

            <!-- Newsletter Subscription Management -->
            <h3 style="color: #37003c;">üìß Newsletter Subscription</h3>
            <div id="emailForm">
                <div class="form-group">
                    <label for="email">Email Address:</label>
                    <input type="email" id="email" name="email" required placeholder="Enter your email address">
                </div>
                
                <button type="button" id="checkStatusBtn" class="btn btn-primary">Check Status</button>
            </div>

            <div id="statusDisplay" style="display: none;">
                <div class="subscription-status">
                    <div id="statusIndicator" class="status-indicator"></div>
                    <div id="statusDetails"></div>
                </div>

                <div id="actionButtons" class="action-buttons">
                    <button type="button" id="unsubscribeBtn" class="btn btn-danger">Unsubscribe</button>
                    <button type="button" id="resubscribeBtn" class="btn btn-success">Resubscribe</button>
                </div>

                <button type="button" id="checkAnotherBtn" class="btn btn-primary" style="margin-top: 15px;">Check Another Email</button>
            </div>
        </div>

        <div class="back-link">
            <a href="/">‚Üê Back to EPL News Hub</a>
        </div>
    </div>

    <!-- Comprehensive SEO Content Section -->
    <div style="background: #f8f9fa; padding: 60px 20px; margin-top: 40px;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <!-- Subscription Management and Benefits -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Complete Subscription Management and Control
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px;">
                        EPL News Hub provides comprehensive subscription management tools that give you complete control over your newsletter preferences, premium memberships, and account settings. Our platform is designed to be transparent, flexible, and user-friendly, ensuring you can easily manage your subscriptions according to your preferences and needs.
                    </p>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Newsletter Subscription Management</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Our newsletter subscription system provides complete flexibility and control over your email preferences. Whether you want to temporarily pause notifications, permanently unsubscribe, or reactivate your subscription after a break, our management tools make the process simple and immediate. You maintain full control over when and how you receive EPL News Hub content.
                    </p>
                    
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        The newsletter management system tracks your subscription history, allowing you to see when you first subscribed, any periods of inactivity, and your overall engagement with our content. This transparency helps you make informed decisions about your subscription preferences and ensures you never lose track of your account status.
                    </p>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Premium Membership Control</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        For premium subscribers, our management platform integrates seamlessly with Stripe's secure billing system to provide comprehensive subscription control. You can view your current plan, check billing history, update payment methods, and manage subscription settings through industry-leading security protocols that protect your financial information.
                    </p>
                    
                    <div style="background: linear-gradient(135deg, #e8f4fd, #d4e7fc); padding: 30px; border-radius: 12px; margin: 30px 0; border-left: 4px solid #37003c;">
                        <h4 style="color: #37003c; margin-bottom: 15px; font-size: 1.3rem;">Secure Billing Management</h4>
                        <p style="line-height: 1.8; margin-bottom: 15px;">
                            "All premium subscription billing is handled through Stripe, the world's most trusted payment processing platform. This ensures your payment information is never stored on our servers and remains protected by enterprise-grade security measures. You can manage billing details, update payment methods, and control subscription settings through Stripe's secure customer portal."
                        </p>
                        <p style="color: #666; font-size: 0.9rem;">- Your financial security is our priority with bank-level encryption and fraud protection</p>
                    </div>
                    
                    <h3 style="color: #37003c; font-size: 1.5rem; margin: 30px 0 20px 0;">Subscription Flexibility and Options</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        We believe in providing maximum flexibility for our subscribers. Whether you need to temporarily pause your subscription during busy periods, upgrade to access more features, or downgrade to a more suitable plan, our system accommodates your changing needs without penalties or complicated procedures.
                    </p>
                    
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        The subscription management system allows for immediate changes to take effect at appropriate billing cycles, ensuring you never pay for services you don't want and always have access to the features you need. This approach has helped thousands of users maintain long-term relationships with EPL News Hub by adapting to their evolving interests and circumstances.
                    </p>
                </div>
            </section>

            <!-- Newsletter Management Features -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Newsletter Management: Complete Control Over Your Communications
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px;">
                        Our newsletter management system provides sophisticated tools for controlling exactly how and when you receive EPL News Hub content, ensuring your inbox contains only the information you want, when you want it.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 30px; margin-bottom: 40px;">
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 30px; border-radius: 12px;">
                            <h3 style="color: #37003c; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.5rem;">üìß</span> Subscription Status Checking
                            </h3>
                            <p style="line-height: 1.8; margin-bottom: 20px;">
                                Instantly verify your newsletter subscription status by entering your email address. Our system provides comprehensive information about your subscription history, current status, and any recent changes to your preferences. This transparency ensures you always know exactly where you stand with our communications.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>Real-time subscription status verification</li>
                                <li>Complete subscription history and timeline</li>
                                <li>Details about subscription source and preferences</li>
                                <li>Integration with premium membership status</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 30px; border-radius: 12px;">
                            <h3 style="color: #37003c; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.5rem;">‚öôÔ∏è</span> Flexible Subscription Control
                            </h3>
                            <p style="line-height: 1.8; margin-bottom: 20px;">
                                Modify your subscription preferences with immediate effect through our user-friendly interface. Whether you want to unsubscribe temporarily, reactivate after a break, or adjust your communication preferences, the system responds instantly to ensure your inbox reflects your current preferences.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>Instant unsubscribe and resubscribe functionality</li>
                                <li>Temporary subscription pausing options</li>
                                <li>Preference updates with immediate implementation</li>
                                <li>No waiting periods or confirmation delays</li>
                            </ul>
                        </div>
                    </div>
                    
                    <h3 style="color: #37003c; margin-bottom: 20px;">Newsletter Content and Frequency</h3>
                    <p style="line-height: 1.8; margin-bottom: 25px;">
                        Our newsletter delivers carefully curated content every Saturday morning, ensuring you receive the most important Premier League developments, FPL insights, and exclusive analysis without overwhelming your inbox. The content is strategically timed to arrive when you're most likely to have time for detailed reading and analysis.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #155724; margin-bottom: 10px;">üìÖ Weekly Schedule</h4>
                            <p style="margin: 0; font-size: 0.95rem; line-height: 1.6;">Every Saturday morning with the week's most important developments and insights.</p>
                        </div>
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #155724; margin-bottom: 10px;">üìä Curated Content</h4>
                            <p style="margin: 0; font-size: 0.95rem; line-height: 1.6;">Hand-selected articles and analysis pieces chosen for maximum value and relevance.</p>
                        </div>
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #155724; margin-bottom: 10px;">üéØ Quality Focus</h4>
                            <p style="margin: 0; font-size: 0.95rem; line-height: 1.6;">Premium insights and FPL strategies unavailable through casual football news sources.</p>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #fff3cd, #ffeaa7); padding: 25px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: #856404; margin-bottom: 15px;">üì® Privacy and Communication Standards</h4>
                        <p style="line-height: 1.8; color: #856404; margin-bottom: 15px;">Your email address is never shared with third parties, and we maintain strict anti-spam policies. Our newsletter system includes automatic list management, bounce handling, and subscription verification to ensure high deliverability and compliance with email marketing best practices.</p>
                        <ul style="margin-left: 20px; line-height: 1.6; color: #856404;">
                            <li>GDPR compliant data handling and storage</li>
                            <li>CAN-SPAM Act compliance with clear unsubscribe options</li>
                            <li>No sharing of subscriber information with external parties</li>
                            <li>Professional email infrastructure for reliable delivery</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Premium Subscription Management -->
            <section style="margin-bottom: 80px;">
                <h2 style="font-size: 2.5rem; color: #37003c; text-align: center; margin-bottom: 30px; font-weight: 800;">
                    Premium Subscription Management and Billing Control
                </h2>
                <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #333; margin-bottom: 30px; text-align: center;">
                        Professional subscription management through secure, industry-leading billing infrastructure that prioritizes your security and convenience.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; margin-bottom: 40px;">
                        <div style="background: linear-gradient(135deg, #f0f8ff, #e6f3ff); padding: 30px; border-radius: 12px; border-left: 4px solid #007bff;">
                            <h3 style="color: #007bff; margin-bottom: 20px; font-size: 1.4rem;">üí≥ Secure Billing Management</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                All premium subscription billing is handled through Stripe, the world's most trusted payment processor used by millions of businesses globally. This ensures your payment information receives bank-level security protection while providing convenient access to comprehensive billing management tools.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>PCI DSS compliant payment processing</li>
                                <li>Advanced fraud detection and prevention</li>
                                <li>Secure payment method storage and management</li>
                                <li>Comprehensive billing history and receipt access</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f0fff0, #e8f5e8); padding: 30px; border-radius: 12px; border-left: 4px solid #28a745;">
                            <h3 style="color: #28a745; margin-bottom: 20px; font-size: 1.4rem;">‚öôÔ∏è Subscription Flexibility</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Modify your premium subscription at any time with options to upgrade, downgrade, pause, or cancel according to your needs. Our flexible system ensures you pay only for what you use while maintaining access to premium features throughout your billing period.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Instant plan upgrades and downgrades</li>
                                <li>Prorated billing for mid-cycle changes</li>
                                <li>Subscription pausing options for breaks</li>
                                <li>No penalty cancellation with continued access</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #fff3cd, #ffeaa7); padding: 30px; border-radius: 12px; border-left: 4px solid #ffc107;">
                            <h3 style="color: #856404; margin-bottom: 20px; font-size: 1.4rem;">üìà Usage Analytics and Value Tracking</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Premium subscribers receive detailed analytics about their subscription usage, content engagement, and value received. This transparency helps you understand exactly how your investment in premium access translates into improved FPL performance and enhanced football knowledge.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>Content consumption analytics and engagement metrics</li>
                                <li>FPL performance improvement tracking</li>
                                <li>Value-per-dollar analysis for subscription optimization</li>
                                <li>Feature usage statistics and recommendations</li>
                            </ul>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f8d7da, #f1b0b7); padding: 30px; border-radius: 12px; border-left: 4px solid #dc3545;">
                            <h3 style="color: #721c24; margin-bottom: 20px; font-size: 1.4rem;">üõ°Ô∏è Customer Support and Protection</h3>
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                Comprehensive customer support ensures you always have assistance when needed. Our support system includes automated billing support, technical assistance, and direct access to our team for any subscription-related questions or concerns.
                            </p>
                            <ul style="margin-left: 20px; line-height: 1.6; font-size: 0.95rem;">
                                <li>24/7 automated billing support and FAQ access</li>
                                <li>Direct email support for complex subscription issues</li>
                                <li>Proactive communication about billing changes</li>
                                <li>Satisfaction guarantee with hassle-free refund policy</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #37003c, #6f42c1); color: white; padding: 40px; border-radius: 12px; text-align: center;">
                        <h3 style="margin-bottom: 20px; font-size: 1.8rem;">Need Subscription Support?</h3>
                        <p style="margin-bottom: 30px; font-size: 1.1rem; opacity: 0.9; max-width: 600px; margin-left: auto; margin-right: auto;">
                            Our support team is ready to help with any subscription questions, billing concerns, or account management needs. Contact us for personalized assistance with your EPL News Hub experience.
                        </p>
                        <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                            <a href="mailto:reidwcoleman@gmail.com" style="display: inline-block; background: #28a745; color: white; padding: 16px 30px; border-radius: 8px; text-decoration: none; font-size: 1.1rem; font-weight: 600;">
                                Contact Support
                            </a>
                            <a href="/membership.html" style="display: inline-block; background: rgba(255,255,255,0.2); color: white; padding: 16px 30px; border-radius: 8px; text-decoration: none; font-size: 1.1rem; font-weight: 600; border: 2px solid rgba(255,255,255,0.3);">
                                View Premium Plans
                            </a>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    
    <script>
        const emailInput = document.getElementById('email');
        const checkStatusBtn = document.getElementById('checkStatusBtn');
        const emailForm = document.getElementById('emailForm');
        const statusDisplay = document.getElementById('statusDisplay');
        const statusIndicator = document.getElementById('statusIndicator');
        const statusDetails = document.getElementById('statusDetails');
        const actionButtons = document.getElementById('actionButtons');
        const unsubscribeBtn = document.getElementById('unsubscribeBtn');
        const resubscribeBtn = document.getElementById('resubscribeBtn');
        const checkAnotherBtn = document.getElementById('checkAnotherBtn');
        const messagesDiv = document.getElementById('messages');
        const contactSupportBtn = document.getElementById('contactSupport');
        const cancelSubscriptionBtn = document.getElementById('cancelSubscription');

        function showMessage(message, type = 'info') {
            messagesDiv.innerHTML = `<div class="message ${type}-message" style="display: block;">${message}</div>`;
        }

        function clearMessages() {
            messagesDiv.innerHTML = '';
        }

        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        checkStatusBtn.addEventListener('click', function() {
            const email = emailInput.value.trim();
            
            if (!email || !isValidEmail(email)) {
                showMessage('Please enter a valid email address.', 'error');
                return;
            }

            checkStatusBtn.textContent = 'Checking...';
            checkStatusBtn.disabled = true;
            clearMessages();

            // Simulate API delay for better UX
            setTimeout(() => {
                try {
                    // Check localStorage for subscription data
                    const signups = JSON.parse(localStorage.getItem('newsletter-signups') || '[]');
                    const unsubscribed = JSON.parse(localStorage.getItem('unsubscribed-emails') || '[]');
                    
                    const subscription = signups.find(s => s.email.toLowerCase() === email.toLowerCase());
                    const isUnsubscribed = unsubscribed.includes(email.toLowerCase());
                    
                    emailForm.style.display = 'none';
                    statusDisplay.style.display = 'block';
                    
                    if (subscription && !isUnsubscribed) {
                        statusIndicator.textContent = '‚úÖ Subscribed';
                        statusIndicator.className = 'status-indicator subscribed';
                        statusDetails.innerHTML = `
                            <p>You are currently subscribed to our newsletter.</p>
                            <p><strong>Email:</strong> ${email}</p>
                            <p><strong>Name:</strong> ${subscription.name || 'Not provided'}</p>
                            ${subscription.timestamp ? 
                                `<p><strong>Subscribed on:</strong> ${new Date(subscription.timestamp).toLocaleDateString()}</p>` : 
                                ''
                            }
                            <p><strong>Status:</strong> Active - You'll receive our weekly newsletter every Saturday morning.</p>
                        `;
                        unsubscribeBtn.style.display = 'inline-block';
                        resubscribeBtn.style.display = 'none';
                    } else if (subscription && isUnsubscribed) {
                        statusIndicator.textContent = '‚ùå Unsubscribed';
                        statusIndicator.className = 'status-indicator not-subscribed';
                        statusDetails.innerHTML = `
                            <p>You have unsubscribed from our newsletter.</p>
                            <p><strong>Email:</strong> ${email}</p>
                            <p><strong>Originally subscribed:</strong> ${subscription.timestamp ? new Date(subscription.timestamp).toLocaleDateString() : 'Unknown'}</p>
                            <p><strong>Status:</strong> Unsubscribed - You won't receive any newsletters.</p>
                        `;
                        unsubscribeBtn.style.display = 'none';
                        resubscribeBtn.style.display = 'inline-block';
                    } else {
                        statusIndicator.textContent = '‚ùå Not Subscribed';
                        statusIndicator.className = 'status-indicator not-subscribed';
                        statusDetails.innerHTML = `
                            <p>This email address is not in our newsletter database.</p>
                            <p><strong>Email:</strong> ${email}</p>
                            <p><strong>Status:</strong> Not subscribed - You can subscribe to our newsletter on the homepage.</p>
                        `;
                        unsubscribeBtn.style.display = 'none';
                        resubscribeBtn.style.display = 'inline-block';
                    }
                    actionButtons.style.display = 'block';
                } catch (error) {
                    console.error('Error checking subscription:', error);
                    showMessage('An error occurred while checking subscription status.', 'error');
                } finally {
                    checkStatusBtn.textContent = 'Check Status';
                    checkStatusBtn.disabled = false;
                }
            }, 500);
        });

        unsubscribeBtn.addEventListener('click', function() {
            if (!confirm('Are you sure you want to unsubscribe from our newsletter? You can always resubscribe later.')) {
                return;
            }

            const email = emailInput.value.trim().toLowerCase();
            unsubscribeBtn.textContent = 'Unsubscribing...';
            unsubscribeBtn.disabled = true;

            setTimeout(() => {
                try {
                    // Add email to unsubscribed list
                    const unsubscribed = JSON.parse(localStorage.getItem('unsubscribed-emails') || '[]');
                    if (!unsubscribed.includes(email)) {
                        unsubscribed.push(email);
                        localStorage.setItem('unsubscribed-emails', JSON.stringify(unsubscribed));
                    }

                    // Log the unsubscription
                    console.log('Unsubscribed email:', email, 'at', new Date().toISOString());

                    showMessage('‚úÖ Successfully unsubscribed from newsletter. You will no longer receive our weekly emails.', 'success');
                    statusIndicator.textContent = '‚ùå Unsubscribed';
                    statusIndicator.className = 'status-indicator not-subscribed';
                    statusDetails.innerHTML = `
                        <p>You have been unsubscribed from our newsletter.</p>
                        <p><strong>Email:</strong> ${emailInput.value.trim()}</p>
                        <p><strong>Unsubscribed on:</strong> ${new Date().toLocaleDateString()}</p>
                        <p><strong>Status:</strong> Unsubscribed - You won't receive any newsletters.</p>
                    `;
                    unsubscribeBtn.style.display = 'none';
                    resubscribeBtn.style.display = 'inline-block';
                } catch (error) {
                    console.error('Error unsubscribing:', error);
                    showMessage('An error occurred while unsubscribing. Please try again.', 'error');
                } finally {
                    unsubscribeBtn.textContent = 'Unsubscribe';
                    unsubscribeBtn.disabled = false;
                }
            }, 800);
        });

        resubscribeBtn.addEventListener('click', function() {
            const email = emailInput.value.trim();
            resubscribeBtn.textContent = 'Subscribing...';
            resubscribeBtn.disabled = true;

            setTimeout(() => {
                try {
                    const emailLower = email.toLowerCase();
                    
                    // Remove from unsubscribed list
                    const unsubscribed = JSON.parse(localStorage.getItem('unsubscribed-emails') || '[]');
                    const filteredUnsubscribed = unsubscribed.filter(e => e !== emailLower);
                    localStorage.setItem('unsubscribed-emails', JSON.stringify(filteredUnsubscribed));

                    // Check if already in signups, if not add them
                    const signups = JSON.parse(localStorage.getItem('newsletter-signups') || '[]');
                    let subscription = signups.find(s => s.email.toLowerCase() === emailLower);
                    
                    if (!subscription) {
                        // Create new subscription entry
                        subscription = {
                            name: 'Newsletter Subscriber',
                            email: email,
                            timestamp: new Date().toISOString()
                        };
                        signups.push(subscription);
                        localStorage.setItem('newsletter-signups', JSON.stringify(signups));
                    }

                    // Log the resubscription
                    console.log('Resubscribed email:', email, 'at', new Date().toISOString());

                    showMessage('‚úÖ Successfully subscribed to newsletter! You\'ll receive our weekly emails every Saturday morning.', 'success');
                    statusIndicator.textContent = '‚úÖ Subscribed';
                    statusIndicator.className = 'status-indicator subscribed';
                    statusDetails.innerHTML = `
                        <p>You are now subscribed to our newsletter.</p>
                        <p><strong>Email:</strong> ${email}</p>
                        <p><strong>Name:</strong> ${subscription.name || 'Newsletter Subscriber'}</p>
                        <p><strong>Subscribed on:</strong> ${new Date(subscription.timestamp).toLocaleDateString()}</p>
                        <p><strong>Status:</strong> Active - You'll receive our weekly newsletter every Saturday morning.</p>
                    `;
                    unsubscribeBtn.style.display = 'inline-block';
                    resubscribeBtn.style.display = 'none';
                } catch (error) {
                    console.error('Error resubscribing:', error);
                    showMessage('An error occurred while subscribing. Please try again.', 'error');
                } finally {
                    resubscribeBtn.textContent = 'Resubscribe';
                    resubscribeBtn.disabled = false;
                }
            }, 800);
        });

        checkAnotherBtn.addEventListener('click', function() {
            emailForm.style.display = 'block';
            statusDisplay.style.display = 'none';
            emailInput.value = '';
            clearMessages();
        });

        // Auto-populate email from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const emailParam = urlParams.get('email');
        if (emailParam) {
            emailInput.value = decodeURIComponent(emailParam);
        }

        // Allow Enter key to check status
        emailInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                checkStatusBtn.click();
            }
        });

        // Contact support functionality
        contactSupportBtn.addEventListener('click', function() {
            const supportEmail = 'reidwcoleman@gmail.com';
            const subject = 'Premium Subscription Management Request';
            const body = `Hello Reid,

I need assistance with my premium subscription management. Please help me with:

[ ] Billing questions
[ ] Plan changes 
[ ] Technical issues
[ ] Account access issues
[ ] Other: _______________

My account email: ________________

Thank you!`;

            const mailtoUrl = `mailto:${supportEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            // Try to open email client
            window.location.href = mailtoUrl;
            
            // Show confirmation message
            showMessage('Opening your email client to contact reidwcoleman@gmail.com for support. If this doesn\'t work, please email reidwcoleman@gmail.com directly.', 'info');
        });

        // Cancel subscription functionality
        cancelSubscriptionBtn.addEventListener('click', function() {
            const supportEmail = 'reidwcoleman@gmail.com';
            const subject = 'Subscription Cancellation Request';
            const body = `Hello Reid,

I would like to cancel my premium subscription to EPL News Hub.

My account details:
- Email: ________________
- Current Plan: ________________
- Reason for cancellation (optional): ________________

Please confirm the cancellation and let me know when it will take effect.

Thank you!`;

            const mailtoUrl = `mailto:${supportEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            // Try to open email client
            window.location.href = mailtoUrl;
            
            // Show confirmation message
            showMessage('Opening your email client to request subscription cancellation from reidwcoleman@gmail.com. If this doesn\'t work, please email reidwcoleman@gmail.com directly.', 'info');
        });
    </script>
</body>
</html>